{"version":3,"file":"angular-three-core-audios.js","sources":["../../../../packages/core/audios/src/lib/audio-listener/audio-listener.directive.ts","../../../../packages/core/audios/src/lib/audio-listener/audio-listener.module.ts","../../../../packages/core/audios/src/lib/abstracts/audio.abstract.ts","../../../../packages/core/audios/src/lib/positional-audio/positional-audio.directive.ts","../../../../packages/core/audios/src/lib/positional-audio/positional-audio.module.ts","../../../../packages/core/audios/src/angular-three-core-audios.ts"],"sourcesContent":["import { CanvasStore, DestroyedService } from '@angular-three/core';\nimport {\n  Directive,\n  EventEmitter,\n  Input,\n  NgZone,\n  OnInit,\n  Output,\n  SkipSelf,\n} from '@angular/core';\nimport { takeUntil } from 'rxjs/operators';\nimport { AudioListener } from 'three';\n\n@Directive({\n  selector: 'ngt-audio-listener',\n  exportAs: 'ngtAudioListener',\n  providers: [DestroyedService],\n})\nexport class AudioListenerDirective implements OnInit {\n  @Input() filter?: AudioNode;\n  @Input() timeDelta?: number;\n\n  @Output() ready = new EventEmitter<AudioListener>();\n\n  private _listener!: AudioListener;\n\n  constructor(\n    @SkipSelf() private readonly canvasStore: CanvasStore,\n    private readonly destroyed: DestroyedService,\n    private readonly ngZone: NgZone\n  ) {}\n\n  ngOnInit() {\n    this.ngZone.runOutsideAngular(() => {\n      this._listener = new AudioListener();\n\n      if (this.filter) {\n        this._listener.filter = this.filter;\n      }\n\n      if (this.timeDelta) {\n        this._listener.timeDelta = this.timeDelta;\n      }\n\n      this.canvasStore.active$\n        .pipe(takeUntil(this.destroyed))\n        .subscribe((active) => {\n          this.ngZone.runOutsideAngular(() => {\n            const { camera } = this.canvasStore.getImperativeState();\n            if (active && camera) {\n              camera.add(this.audioListener);\n              this.ready.emit(this.audioListener);\n            }\n          });\n        });\n    });\n  }\n\n  get audioListener(): AudioListener {\n    return this._listener;\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { AudioListenerDirective } from './audio-listener.directive';\n\n@NgModule({\n  declarations: [AudioListenerDirective],\n  exports: [AudioListenerDirective],\n})\nexport class ThreeAudioListenerModule {}\n","import { AnyConstructor, ThreeObject3d } from '@angular-three/core';\nimport {\n  Directive,\n  EventEmitter,\n  Input,\n  OnInit,\n  Optional,\n  Output,\n  SkipSelf,\n} from '@angular/core';\nimport type { Object3D } from 'three';\nimport { Audio } from 'three';\nimport { AudioListenerDirective } from '../audio-listener';\n\n@Directive()\nexport abstract class ThreeAudio<\n  TAudioNode extends AudioNode = GainNode,\n  TAudio extends Audio<TAudioNode> = Audio<TAudioNode>\n> implements OnInit\n{\n  @Input() object3d?: Object3D;\n\n  @Output() ready = new EventEmitter<TAudio>();\n\n  constructor(\n    @Optional()\n    @SkipSelf()\n    private readonly listenerDirective?: AudioListenerDirective,\n    @Optional()\n    @SkipSelf()\n    protected readonly parentObjectDirective?: ThreeObject3d\n  ) {}\n\n  abstract audioType: AnyConstructor<TAudio>;\n\n  private _audio?: TAudio;\n\n  ngOnInit() {\n    if (!this.listenerDirective) {\n      console.error('AudioListener must exist to initialize Audio');\n      return;\n    }\n\n    this._audio = new this.audioType(this.listenerDirective.audioListener);\n\n    if (this.audio) {\n      if (this.object3d) {\n        this.object3d.add(this.audio);\n      } else if (this.parentObjectDirective) {\n        this.parentObjectDirective.object3d.add(this.audio);\n      }\n    }\n\n    this.ready.emit(this.audio);\n  }\n\n  get audio(): TAudio | undefined {\n    return this._audio;\n  }\n}\n","import { Directive } from '@angular/core';\nimport { PositionalAudio } from 'three';\nimport { ThreeAudio } from '../abstracts';\n\n@Directive({\n  selector: 'ngt-positional-audio',\n  exportAs: 'ngtPositionalAudio',\n})\nexport class PositionalAudioDirective extends ThreeAudio<\n  PannerNode,\n  PositionalAudio\n> {\n  audioType = PositionalAudio;\n}\n","import { NgModule } from '@angular/core';\nimport { PositionalAudioDirective } from './positional-audio.directive';\n\n@NgModule({\n  declarations: [PositionalAudioDirective],\n  exports: [PositionalAudioDirective],\n})\nexport class ThreePositionalAudioModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":"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"}