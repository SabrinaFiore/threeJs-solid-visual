{"version":3,"file":"angular-three-core.umd.js","sources":["../../../../node_modules/tslib/tslib.es6.js","../../../../packages/core/src/lib/utils/make-id.util.ts","../../../../packages/core/src/lib/utils/events.util.ts","../../../../packages/core/src/lib/utils/apply-props.util.ts","../../../../packages/core/src/lib/stores/imperative-component-store.abstract.ts","../../../../packages/core/src/lib/stores/animation.store.ts","../../../../packages/core/src/lib/stores/canvas.store.ts","../../../../packages/core/src/lib/stores/instances.store.ts","../../../../packages/core/src/lib/stores/events.store.ts","../../../../packages/core/src/lib/services/loop.service.ts","../../../../packages/core/src/lib/services/destroyed.service.ts","../../../../packages/core/src/lib/services/loader.service.ts","../../../../packages/core/src/lib/canvas.component.ts","../../../../packages/core/src/lib/controllers/controller.abstract.ts","../../../../packages/core/src/lib/controllers/object-3d-controller.directive.ts","../../../../packages/core/src/lib/core.module.ts","../../../../packages/core/src/lib/di/object-3d-watched-controller.di.ts","../../../../packages/core/src/lib/abstracts/animation-loop-participant.abstract.ts","../../../../packages/core/src/lib/abstracts/object-3d.abstract.ts","../../../../packages/core/src/lib/abstracts/object-3d-material-geometry.abstract.ts","../../../../packages/core/src/lib/abstracts/material.abstract.ts","../../../../packages/core/src/lib/abstracts/texture.abstract.ts","../../../../packages/core/src/lib/abstracts/light.abstract.ts","../../../../packages/core/src/lib/abstracts/helper.abstract.ts","../../../../packages/core/src/lib/abstracts/geometry.abstract.ts","../../../../packages/core/src/lib/abstracts/curve.abstract.ts","../../../../packages/core/src/lib/abstracts/attribute.abstract.ts","../../../../packages/core/src/lib/abstracts/line.abstract.ts","../../../../packages/core/src/lib/abstracts/mesh.abstract.ts","../../../../packages/core/src/lib/abstracts/sprite.abstract.ts","../../../../packages/core/src/lib/abstracts/camera.abstract.ts","../../../../packages/core/src/lib/primitive/primitive.directive.ts","../../../../packages/core/src/lib/primitive/primitive.module.ts","../../../../packages/core/src/lib/pipes/math/math.pipe.ts","../../../../packages/core/src/lib/pipes/math/math.module.ts","../../../../packages/core/src/lib/pipes/math-constant/math-constant.pipe.ts","../../../../packages/core/src/lib/pipes/math-constant/math-constant.module.ts","../../../../packages/core/src/lib/pipes/color/color.pipe.ts","../../../../packages/core/src/lib/pipes/color/color.module.ts","../../../../packages/core/src/lib/pipes/fog/fog.pipe.ts","../../../../packages/core/src/lib/pipes/fog/fog.module.ts","../../../../packages/core/src/lib/directives/repeat/repeat.directive.ts","../../../../packages/core/src/lib/directives/repeat/repeat.module.ts","../../../../packages/core/src/angular-three-core.ts"],"sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n","import type { ThreeIntersection } from '../typings';\n\n/**\n * Generate a random Id or an Event's uuid\n *\n * @param {ThreeIntersection} event\n *\n * @internal\n * @private\n */\nexport function makeId(event?: ThreeIntersection) {\n  if (event) {\n    return (event.eventObject || event.object).uuid + '/' + event.index;\n  }\n\n  return id();\n}\n\nconst cache: { [id: string]: boolean | undefined } = {};\n\n/**\n * Generates a short id.\n *\n * Description:\n *  A 5-character alphanumeric sequence (364 = 1.6 million)\n *  This should only be used for JavaScript specific models.\n *  http://stackoverflow.com/questions/6248666/how-to-generate-short-uid-like-ax4j9z-in-js\n *\n *  Example: `aebgf`\n */\nexport function id(): string {\n  let newId = (\n    '0000' + ((Math.random() * Math.pow(36, 4)) << 0).toString(36)\n  ).slice(-4);\n\n  newId = `a${newId}`;\n\n  // ensure not already used\n  if (!cache[newId]) {\n    cache[newId] = true;\n    return newId;\n  }\n\n  return id();\n}\n","import type { Object3D } from 'three';\nimport { Vector3 } from 'three';\nimport type {\n  CanvasStoreState,\n  EventHandlers,\n  EventsStoreState,\n  InstanceInternal,\n  InstancesStoreState,\n  ThreeDomEvent,\n  ThreeEvent,\n  ThreeInstance,\n  ThreeIntersection,\n  UnknownRecord,\n} from '../typings';\nimport { makeId } from './make-id.util';\n\n/**\n * From r3f https://github.com/pmndrs/react-three-fiber/blob/master/packages/fiber/src/core/events.ts\n */\nexport function createEvents(\n  canvasStateGetter: () => CanvasStoreState,\n  eventsStateGetter: () => EventsStoreState,\n  instancesStateGetter: () => InstancesStoreState\n) {\n  const temp = new Vector3();\n\n  /** Sets up defaultRaycaster */\n  function prepareRay(event: ThreeDomEvent) {\n    const {\n      raycaster,\n      mouse,\n      camera,\n      clock,\n      renderer,\n      scene,\n      internal: { size, viewport },\n    } = canvasStateGetter();\n    const delta = clock.getDelta();\n    if (raycaster && camera && renderer && scene) {\n      const { offsetX, offsetY } =\n        raycaster.computeOffsets?.(event, {\n          camera,\n          clock,\n          size,\n          viewport,\n          renderer,\n          scene,\n          delta,\n          mouse,\n        }) ?? event;\n      const { width, height } = size;\n      mouse.set((offsetX / width) * 2 - 1, -(offsetY / height) * 2 + 1);\n      raycaster.setFromCamera(mouse, camera);\n    }\n  }\n\n  /** Calculates delta */\n  function calculateDistance(event: ThreeDomEvent) {\n    const {\n      internal: { initialClick },\n    } = eventsStateGetter();\n    const dx = event.offsetX - initialClick[0];\n    const dy = event.offsetY - initialClick[1];\n    return Math.round(Math.sqrt(dx * dx + dy * dy));\n  }\n\n  /** Returns true if an instance has a valid pointer-event registered, this excludes scroll, clicks etc */\n  function filterPointerEvents(objects: Object3D[]) {\n    return objects.filter((obj) =>\n      ['move', 'over', 'enter', 'out', 'leave'].some(\n        (name) =>\n          (obj as unknown as ThreeInstance).__ngt?.handlers?.[\n            ('pointer' + name) as keyof InstanceInternal['handlers']\n          ]\n      )\n    );\n  }\n\n  function intersect(filter?: (objects: Object3D[]) => Object3D[]) {\n    const { raycaster } = canvasStateGetter();\n    const { objects } = instancesStateGetter();\n    // Skip event handling when noEvents is set\n    if (!raycaster || (raycaster && !raycaster.enabled)) return [];\n\n    const seen = new Set<string>();\n    const intersections: ThreeIntersection[] = [];\n\n    // Allow callers to eliminate event objects\n    const eventsObjects = filter\n      ? filter(Object.values(objects))\n      : Object.values(objects);\n\n    // Intersect known handler objects and filter against duplicates\n    const intersects = raycaster\n      .intersectObjects(eventsObjects, true)\n      .filter((item) => {\n        const id = makeId(item as ThreeIntersection);\n        if (seen.has(id)) return false;\n        seen.add(id);\n        return true;\n      });\n\n    // https://github.com/mrdoob/three.js/issues/16031\n    // Allow custom userland intersect sort order\n    // if (raycaster.filter) intersects = raycaster.filter(intersects, state);\n\n    for (const intersect of intersects) {\n      let eventObject: Object3D | null = intersect.object;\n      // Bubble event up\n      while (eventObject) {\n        const handlers = (eventObject as unknown as ThreeInstance).__ngt\n          ?.handlers;\n        if (handlers) intersections.push({ ...intersect, eventObject });\n        eventObject = eventObject.parent;\n      }\n    }\n    return intersections;\n  }\n\n  /**  Creates filtered intersects and returns an array of positive hits */\n  function patchIntersects(\n    intersections: ThreeIntersection[],\n    event: ThreeDomEvent\n  ) {\n    const {\n      internal: { capturedMap },\n    } = eventsStateGetter();\n    // If the interaction is captured take that into account, the captured event has to be part of the intersects\n    if ('pointerId' in event && capturedMap.has(event.pointerId)) {\n      intersections.push(...capturedMap.get(event.pointerId)!.values());\n    }\n\n    return intersections;\n  }\n\n  /**  Handles intersections by forwarding them to handlers */\n  function handleIntersects(\n    intersections: ThreeIntersection[],\n    event: ThreeDomEvent,\n    callback: (event: ThreeDomEvent) => void\n  ) {\n    const { raycaster, mouse, camera } = canvasStateGetter();\n    const { internal: eventsInternal } = eventsStateGetter();\n    // If anything has been found, forward it to the event listeners\n    if (intersections.length && camera) {\n      const unprojectedPoint = temp.set(mouse.x, mouse.y, 0).unproject(camera);\n      const delta = event.type === 'click' ? calculateDistance(event) : 0;\n      const releasePointerCapture = (id: number) =>\n        (event.target as Element).releasePointerCapture(id);\n      const localState = { stopped: false };\n\n      for (const hit of intersections) {\n        const hasPointerCapture = (id: number) =>\n          eventsInternal.capturedMap.get(id)?.has(hit.eventObject) ?? false;\n\n        const setPointerCapture = (id: number) => {\n          if (eventsInternal.capturedMap.has(id)) {\n            // if the pointerId was previously captured, we add the hit to the\n            // event capturedMap.\n            eventsInternal.capturedMap.get(id)!.set(hit.eventObject, hit);\n          } else {\n            // if the pointerId was not previously captured, we create a map\n            // containing the hitObject, and the hit. hitObject is used for\n            // faster access.\n            eventsInternal.capturedMap.set(\n              id,\n              new Map([[hit.eventObject, hit]])\n            );\n          }\n\n          // Call the original event now\n          (event.target as Element).setPointerCapture(id);\n        };\n\n        // Add native event props\n        const extractEventProps: UnknownRecord = {};\n        for (const prop in Object.getPrototypeOf(event)) {\n          // noinspection JSUnfilteredForInLoop\n          const property = event[prop as keyof ThreeDomEvent];\n          // Only copy over atomics, leave functions alone as these should be\n          // called as event.nativeEvent.fn()\n          if (typeof property !== 'function') {\n            // noinspection JSUnfilteredForInLoop\n            extractEventProps[prop] = property;\n          }\n        }\n\n        const raycastEvent = {\n          ...hit,\n          ...extractEventProps,\n          spaceX: mouse.x,\n          spaceY: mouse.y,\n          intersections,\n          stopped: localState.stopped,\n          delta,\n          unprojectedPoint,\n          ray: raycaster ? raycaster.ray : null,\n          camera,\n          // Hijack stopPropagation, which just sets a flag\n          stopPropagation: () => {\n            // https://github.com/pmndrs/react-three-fiber/issues/596\n            // Events are not allowed to stop propagation if the pointer has been captured\n            const capturesForPointer =\n              'pointerId' in event &&\n              eventsInternal.capturedMap.get(event.pointerId);\n\n            // We only authorize stopPropagation...\n            if (\n              // ...if this pointer hasn't been captured\n              !capturesForPointer ||\n              // ... or if the hit object is capturing the pointer\n              capturesForPointer.has(hit.eventObject)\n            ) {\n              raycastEvent.stopped = localState.stopped = true;\n              // Propagation is stopped, remove all other hover records\n              // An event handler is only allowed to flush other handlers if it is hovered itself\n              if (\n                eventsInternal.hovered.size &&\n                Array.from(eventsInternal.hovered.values()).find(\n                  (i) => i.eventObject === hit.eventObject\n                )\n              ) {\n                // Objects cannot flush out higher up objects that have already caught the event\n                const higher = intersections.slice(\n                  0,\n                  intersections.indexOf(hit)\n                );\n                cancelPointer([...higher, hit]);\n              }\n            }\n          },\n          target: {\n            ...event.target,\n            setPointerCapture,\n            releasePointerCapture,\n            hasPointerCapture,\n          },\n          currentTarget: {\n            ...event.currentTarget,\n            setPointerCapture,\n            releasePointerCapture,\n            hasPointerCapture,\n          },\n          sourceEvent: event,\n          nativeEvent: event,\n        };\n\n        // Call subscribers\n        callback(raycastEvent as unknown as ThreeDomEvent);\n        // Event bubbling may be interrupted by stopPropagation\n        if (localState.stopped) break;\n      }\n    }\n    return intersections;\n  }\n\n  function cancelPointer(hits: ThreeIntersection[]) {\n    const { internal } = eventsStateGetter();\n    Array.from(internal.hovered.values()).forEach((hoveredObj) => {\n      // When no objects were hit or the the hovered object wasn't found underneath the cursor\n      // we call onPointerOut and delete the object from the hovered-elements map\n      if (\n        !hits.length ||\n        !hits.find(\n          (hit) =>\n            hit.object === hoveredObj.object && hit.index === hoveredObj.index\n        )\n      ) {\n        const eventObject = hoveredObj.eventObject;\n        const handlers = (eventObject as unknown as ThreeInstance).__ngt\n          ?.handlers;\n        internal.hovered.delete(makeId(hoveredObj));\n        if (handlers) {\n          // Clear out intersects, they are outdated by now\n          const data = { ...hoveredObj, intersections: hits || [] };\n          handlers.pointerout?.(data as ThreeEvent<PointerEvent>);\n          handlers.pointerleave?.(data as ThreeEvent<PointerEvent>);\n        }\n      }\n    });\n  }\n\n  const handlePointer = (name: string) => {\n    // Deal with cancellation\n    switch (name) {\n      case 'pointerleave':\n      case 'pointercancel':\n        return () => cancelPointer([]);\n      case 'lostpointercapture':\n        return (event: ThreeDomEvent) => {\n          if ('pointerId' in event) {\n            // this will be a problem if one target releases the pointerId\n            // and another one is still keeping it, as the line below\n            // indifferently deletes all capturing references.\n            const {\n              internal: { capturedMap },\n            } = eventsStateGetter();\n            capturedMap.delete(event.pointerId);\n          }\n        };\n    }\n\n    // Any other pointer goes here ...\n    return (event: ThreeDomEvent) => {\n      const { internal } = eventsStateGetter();\n      const { objects } = instancesStateGetter();\n\n      prepareRay(event);\n\n      // Get fresh intersects\n      const isPointerMove = name === 'pointermove';\n      const filter = isPointerMove ? filterPointerEvents : undefined;\n      const hits = patchIntersects(intersect(filter), event);\n\n      // Take care of unhover\n      if (isPointerMove) cancelPointer(hits);\n\n      handleIntersects(hits, event, (data: ThreeDomEvent) => {\n        const eventObject = data.eventObject;\n        const handlers = (eventObject as unknown as ThreeInstance).__ngt\n          ?.handlers;\n        // Check presence of handlers\n        if (!handlers) return;\n\n        if (isPointerMove) {\n          // Move event ...\n          if (\n            handlers.pointerover ||\n            handlers.pointerenter ||\n            handlers.pointerout ||\n            handlers.pointerleave\n          ) {\n            // When enter or out is present take care of hover-state\n            const id = makeId(data);\n            const hoveredItem = internal.hovered.get(id);\n            if (!hoveredItem) {\n              // If the object wasn't previously hovered, book it and call its handler\n              internal.hovered.set(id, data);\n              handlers.pointerover?.(data as ThreeEvent<PointerEvent>);\n              handlers.pointerenter?.(data as ThreeEvent<PointerEvent>);\n            } else if (hoveredItem.stopped) {\n              // If the object was previously hovered and stopped, we shouldn't allow other items to proceed\n              data.stopPropagation();\n            }\n          }\n          // Call mouse move\n          handlers.pointermove?.(data as ThreeEvent<PointerEvent>);\n        } else {\n          // All other events ...\n          const handler = handlers?.[name as keyof EventHandlers] as (\n            event: ThreeEvent<PointerEvent>\n          ) => void;\n          if (handler) {\n            // Forward all events back to their respective handlers with the exception of click events,\n            // which must use the initial target\n            if (\n              (name !== 'click' &&\n                name !== 'contextmenu' &&\n                name !== 'dblclick') ||\n              internal.initialHits.includes(eventObject)\n            ) {\n              handler(data as ThreeEvent<PointerEvent>);\n              pointerMissed(\n                event,\n                Object.values(objects).filter(\n                  (object) => object !== eventObject\n                )\n              );\n            }\n          }\n        }\n      });\n\n      // Save initial coordinates on pointer-down\n      if (name === 'pointerdown') {\n        internal.initialClick = [event.offsetX, event.offsetY];\n        internal.initialHits = hits.map((hit) => hit.eventObject);\n      }\n\n      // If a click yields no results, pass it back to the user as a miss\n      if (\n        (name === 'click' || name === 'contextmenu' || name === 'dblclick') &&\n        !hits.length\n      ) {\n        if (calculateDistance(event) <= 2) {\n          pointerMissed(event, Object.values(objects));\n          // if (onPointerMissed) onPointerMissed();\n        }\n      }\n    };\n  };\n\n  function pointerMissed(event: MouseEvent, objects: Object3D[]) {\n    objects.forEach((object: Object3D) =>\n      (object as unknown as ThreeInstance).__ngt?.handlers?.pointermissed?.(\n        event as ThreeEvent<PointerEvent>\n      )\n    );\n  }\n\n  return { handlePointer };\n}\n","import type {\n  InstanceInternal,\n  ThreeInstance,\n  UnknownRecord,\n} from '../typings';\n\nfunction applyDottedPathProps(\n  instance: ThreeInstance,\n  key: string,\n  propAtKey: unknown,\n  isRoot = true\n) {\n  const [first, ...paths] = key.split('.');\n  const rootChild = (instance as unknown as UnknownRecord)[first];\n  if (rootChild == null) {\n    return;\n  }\n\n  if (paths.length >= 1) {\n    applyDottedPathProps(\n      rootChild as unknown as ThreeInstance,\n      paths.join('.'),\n      propAtKey,\n      false\n    );\n  } else {\n    (instance as unknown as UnknownRecord)[first] = propAtKey;\n  }\n\n  if (isRoot) {\n    checkNeedsUpdate(rootChild);\n  }\n}\n\nfunction checkNeedsUpdate(value: unknown) {\n  if (typeof value === 'object' && 'needsUpdate' in (value as UnknownRecord)) {\n    (value as UnknownRecord)['needsUpdate'] = true;\n  }\n}\n\n/**\n * Apply props on instances\n *\n * @internal\n * @private\n */\nexport function applyProps(instance: ThreeInstance, props?: UnknownRecord) {\n  if (!props || (props && !Object.keys(props).length)) return;\n\n  if ('__ngt' in props) {\n    instance['__ngt'] = props['__ngt'] as InstanceInternal;\n  }\n\n  const unknownInstance = instance as unknown as UnknownRecord;\n\n  if (\n    unknownInstance['set'] != null &&\n    typeof unknownInstance['set'] === 'function'\n  ) {\n    (unknownInstance['set'] as Function)(props);\n  }\n\n  for (const [key, propAtKey] of Object.entries(props)) {\n    if (key.split('.').length > 1) {\n      applyDottedPathProps(instance, key, propAtKey);\n    } else {\n      const threeInstancePropAtKey = unknownInstance[key] as UnknownRecord;\n      if (threeInstancePropAtKey == null) {\n        unknownInstance[key] = propAtKey;\n      } else {\n        if (\n          threeInstancePropAtKey['set'] != null &&\n          typeof threeInstancePropAtKey['set'] === 'function'\n        ) {\n          if (Array.isArray(propAtKey)) {\n            if (\n              threeInstancePropAtKey['fromArray'] != null &&\n              typeof threeInstancePropAtKey['fromArray'] === 'function'\n            ) {\n              threeInstancePropAtKey['fromArray'](propAtKey);\n            } else {\n              threeInstancePropAtKey['set'](...propAtKey);\n            }\n          } else {\n            threeInstancePropAtKey['set'](propAtKey);\n          }\n        } else {\n          unknownInstance[key] = propAtKey;\n        }\n      }\n      checkNeedsUpdate(propAtKey);\n    }\n  }\n}\n","import { ComponentStore } from '@ngrx/component-store';\n\nexport abstract class ImperativeComponentStore<\n  T extends object\n> extends ComponentStore<T> {\n  getImperativeState(): T {\n    return this.get();\n  }\n}\n","import { Injectable, OnDestroy } from '@angular/core';\nimport { isObservable, Observable } from 'rxjs';\nimport { filter, skip, tap, withLatestFrom } from 'rxjs/operators';\nimport type { Object3D } from 'three';\nimport type {\n  AnimationCallback,\n  AnimationStoreState,\n  RenderState,\n} from '../typings';\nimport { makeId } from '../utils';\nimport { ImperativeComponentStore } from './imperative-component-store.abstract';\n\n@Injectable()\nexport class AnimationStore\n  extends ImperativeComponentStore<AnimationStoreState>\n  implements OnDestroy\n{\n  constructor() {\n    super({\n      animations: {},\n      objectSubscriptions: [],\n      animationCallbacks: [],\n      hasPriority: false,\n    });\n\n    this.animationsChangedEffect(\n      this.select((s) => s.animations).pipe(skip(1))\n    );\n  }\n\n  readonly animationsChangedEffect = this.effect<\n    AnimationStoreState['animations']\n  >((animations$) =>\n    animations$.pipe(\n      tap((animations) => {\n        const animationCallbacks = Object.values(animations);\n        const hasPriority = animationCallbacks.some(\n          ({ priority }) => !!priority\n        );\n        this.patchState({ animationCallbacks, hasPriority });\n      })\n    )\n  );\n\n  readonly unregisterAnimationEffect = this.effect<string>((uuid$) =>\n    uuid$.pipe(\n      withLatestFrom(this.state$),\n      tap(\n        ([uuid, { animations, objectSubscriptions }]: [\n          string,\n          AnimationStoreState\n        ]) => {\n          const subscription = objectSubscriptions.find(\n            ([objectUuid]) => objectUuid === uuid\n          );\n          if (subscription) {\n            subscription[1].unsubscribe();\n          }\n\n          const { [uuid]: _, ...updatedAnimations } = animations;\n          this.patchState({\n            animations: updatedAnimations,\n            objectSubscriptions: objectSubscriptions.filter(\n              ([objectUuid]) => objectUuid !== uuid\n            ),\n          });\n        }\n      )\n    )\n  );\n\n  readonly clearEffect = this.effect((trigger$) =>\n    trigger$.pipe(\n      tap(() => {\n        this.patchState((state) => {\n          state.objectSubscriptions.forEach(([, subscription]) =>\n            subscription.unsubscribe()\n          );\n          return { animations: {}, objectSubscriptions: [] };\n        });\n      })\n    )\n  );\n\n  registerAnimation<TObject3d extends Object3D = Object3D>(\n    obj: TObject3d,\n    callback: AnimationCallback<TObject3d>,\n    priority?: number\n  ): () => void;\n  registerAnimation<TObject3d extends Object3D = Object3D>(\n    obs: Observable<TObject3d | null>,\n    callback: AnimationCallback<TObject3d>,\n    priority?: number\n  ): () => void;\n  registerAnimation(callback: AnimationCallback, priority?: number): () => void;\n  registerAnimation<TObject3d extends Object3D = Object3D>(\n    objOrObsOrCallback: TObject3d | Observable<TObject3d> | AnimationCallback,\n    callbackOrPriority?:\n      | ((obj: TObject3d, state: RenderState) => void)\n      | number,\n    priority = 0\n  ) {\n    if (objOrObsOrCallback === undefined) return;\n\n    if (typeof objOrObsOrCallback === 'function') {\n      const id = makeId();\n      this.patchState((state) => ({\n        ...state,\n        animations: {\n          ...state.animations,\n          [id]: {\n            obj: null,\n            callback: objOrObsOrCallback,\n            priority: (callbackOrPriority as number) || 0,\n          },\n        },\n      }));\n      return () => {\n        this.unregisterAnimationEffect(id);\n      };\n    }\n\n    if (isObservable(objOrObsOrCallback)) {\n      let id = '';\n      const subscription = objOrObsOrCallback\n        .pipe(filter((obj) => !!obj))\n        .subscribe((obj) => {\n          this.patchState((state) => {\n            const objectSubscriptions = state.objectSubscriptions;\n            if (objectSubscriptions[objectSubscriptions.length - 1]?.[0]) {\n              objectSubscriptions[objectSubscriptions.length - 1][0] = obj.uuid;\n            }\n            id = obj.uuid;\n            return {\n              animations: {\n                ...state.animations,\n                [id]: {\n                  obj,\n                  callback: callbackOrPriority as AnimationCallback<TObject3d>,\n                  priority,\n                },\n              },\n              objectSubscriptions,\n            };\n          });\n        });\n      this.patchState((state) => ({\n        objectSubscriptions: [\n          ...state.objectSubscriptions,\n          [null, subscription],\n        ],\n      }));\n      return () => {\n        this.unregisterAnimationEffect(id);\n      };\n    }\n\n    const uuid = (objOrObsOrCallback as Object3D).uuid;\n    this.patchState((state) => ({\n      animations: {\n        ...state.animations,\n        [uuid]: {\n          obj: objOrObsOrCallback,\n          callback: callbackOrPriority as AnimationCallback<TObject3d>,\n          priority,\n        },\n      },\n    }));\n    return () => {\n      this.unregisterAnimationEffect(uuid);\n    };\n  }\n\n  ngOnDestroy() {\n    this.clearEffect();\n    super.ngOnDestroy();\n  }\n}\n","import { Injectable, OnDestroy } from '@angular/core';\nimport { combineLatest, Observable } from 'rxjs';\nimport { filter, mapTo, tap, withLatestFrom } from 'rxjs/operators';\nimport {\n  ACESFilmicToneMapping,\n  Camera,\n  Clock,\n  OrthographicCamera,\n  PCFSoftShadowMap,\n  PerspectiveCamera,\n  Raycaster,\n  Scene,\n  sRGBEncoding,\n  Vector2,\n  Vector3,\n  WebGLRenderer,\n  WebGLShadowMap,\n} from 'three';\nimport type {\n  CameraOptions,\n  CanvasInternal,\n  CanvasStoreState,\n  RaycasterOptions,\n  SceneOptions,\n  Size,\n  ThreeCameraAlias,\n  ThreeInstance,\n  ThreeRaycaster,\n  UnknownRecord,\n} from '../typings';\nimport { applyProps } from '../utils';\nimport { ImperativeComponentStore } from './imperative-component-store.abstract';\n\ninterface WindowResizeEffectParams {\n  size: Size;\n  dpr: number;\n}\n\nconst position = new Vector3();\nconst defaultTarget = new Vector3();\n\nexport const isOrthographicCamera = (def: Camera): def is OrthographicCamera =>\n  def && (def as OrthographicCamera).isOrthographicCamera;\n\n@Injectable()\nexport class CanvasStore\n  extends ImperativeComponentStore<CanvasStoreState>\n  implements OnDestroy\n{\n  readonly renderer$ = this.select((s) => s.renderer);\n  readonly camera$ = this.select((s) => s.camera);\n  readonly scene$ = this.select((s) => s.scene);\n  readonly raycaster$ = this.select((s) => s.raycaster);\n\n  readonly isOrthographic$ = this.select((s) => s.isOrthographic);\n  readonly isLinear$ = this.select((s) => s.isLinear);\n  readonly shadows$ = this.select((s) => s.shadows);\n  readonly active$ = this.select((s) => s.internal.active);\n  readonly canvasInternal$ = this.select((s) => s.internal);\n\n  constructor() {\n    super({\n      isOrthographic: false,\n      isLinear: false,\n      shadows: false,\n      mouse: new Vector2(),\n      clock: new Clock(),\n      internal: {\n        active: false,\n        size: { width: 0, height: 0 },\n        dpr: 1,\n        viewport: {\n          initialDpr: 1,\n          dpr: 1,\n          width: 0,\n          height: 0,\n          aspect: 0,\n          distance: 0,\n          factor: 0,\n          getCurrentViewport: (\n            camera = this.getImperativeState().camera,\n            target = defaultTarget,\n            size = this.getImperativeState().internal.size\n          ) => {\n            const { width, height } = size;\n            const aspect = width / height;\n            const distance = camera!\n              .getWorldPosition(position)\n              .distanceTo(target);\n            if (isOrthographicCamera(camera!)) {\n              return {\n                width: width / camera.zoom,\n                height: height / camera.zoom,\n                factor: 1,\n                distance,\n                aspect,\n              };\n            }\n\n            const fov = (camera!.fov * Math.PI) / 180; // convert vertical fov to radians\n            const h = 2 * Math.tan(fov / 2) * distance; // visible height\n            const w = h * (width / height);\n            return {\n              width: w,\n              height: h,\n              factor: width / w,\n              distance,\n              aspect,\n            };\n          },\n        },\n      },\n    });\n\n    this.setActive(\n      combineLatest([\n        this.renderer$,\n        this.camera$,\n        this.scene$,\n        this.raycaster$,\n      ]).pipe(\n        filter((coreObjects) => coreObjects.every(Boolean)),\n        mapTo(true)\n      )\n    );\n  }\n\n  readonly setIsOrthographic = this.updater<boolean>(\n    (state, isOrthographic) => ({ ...state, isOrthographic })\n  );\n  readonly setIsLinear = this.updater<boolean>((state, isLinear) => ({\n    ...state,\n    isLinear,\n  }));\n  readonly setShadows = this.updater<boolean | Partial<WebGLShadowMap>>(\n    (state, shadows) => ({\n      ...state,\n      shadows,\n    })\n  );\n  readonly setSize = this.updater<Size>((state, size) => ({\n    ...state,\n    internal: { ...state.internal, size },\n  }));\n  readonly setDpr = this.updater<number>((state, dpr) => ({\n    ...state,\n    internal: { ...state.internal, dpr },\n  }));\n  readonly setViewport = this.updater((state) => ({\n    ...state,\n    internal: {\n      ...state.internal,\n      viewport: {\n        ...state.internal.viewport,\n        ...state.internal.viewport.getCurrentViewport(\n          state.camera,\n          defaultTarget,\n          state.internal.size\n        ),\n        dpr: state.internal.dpr,\n      },\n    },\n  }));\n  readonly setActive = this.updater<boolean>((state, active) => ({\n    ...state,\n    internal: { ...state.internal, active },\n  }));\n\n  readonly initRendererEffect = this.effect<HTMLCanvasElement>((canvas$) => {\n    return canvas$.pipe(\n      withLatestFrom(this.canvasInternal$, this.isLinear$, this.shadows$),\n      tap(\n        ([canvas, { size, dpr }, isLinear, shadows]: [\n          HTMLCanvasElement,\n          CanvasInternal,\n          boolean,\n          boolean | Partial<WebGLShadowMap>\n        ]) => {\n          const renderer = new WebGLRenderer({\n            canvas,\n            antialias: true,\n            powerPreference: 'high-performance',\n            alpha: true,\n          });\n\n          if (shadows) {\n            renderer.shadowMap.enabled = true;\n            if (typeof shadows === 'object')\n              Object.assign(renderer.shadowMap, shadows);\n            else renderer.shadowMap.type = PCFSoftShadowMap;\n          }\n\n          if (!isLinear) {\n            renderer.toneMapping = ACESFilmicToneMapping;\n            renderer.outputEncoding = sRGBEncoding;\n          }\n\n          renderer.setClearAlpha(0);\n          renderer.setPixelRatio(dpr);\n          renderer.setSize(size.width, size.height);\n\n          this.patchState({ renderer });\n        }\n      )\n    );\n  });\n\n  readonly initSceneEffect = this.effect<SceneOptions | undefined>(\n    (sceneOptions$) =>\n      sceneOptions$.pipe(\n        tap((sceneOptions: SceneOptions | undefined) => {\n          const scene = new Scene();\n          applyProps(scene, sceneOptions as UnknownRecord);\n          this.patchState({ scene });\n        })\n      )\n  );\n\n  readonly initCameraEffect = this.effect<CameraOptions | undefined>(\n    (cameraOptions$) =>\n      cameraOptions$.pipe(\n        withLatestFrom(this.isOrthographic$, this.canvasInternal$),\n        tap(\n          ([cameraOptions, isOrthographic, { size }]: [\n            CameraOptions | undefined,\n            boolean,\n            CanvasInternal\n          ]) => {\n            const isCamera = cameraOptions instanceof Camera;\n            let camera: ThreeCameraAlias;\n\n            if (isCamera) {\n              camera = cameraOptions as ThreeCameraAlias;\n            } else {\n              if (isOrthographic) {\n                camera = new OrthographicCamera(0, 0, 0, 0, 0.1, 1000);\n                camera.zoom = 100;\n              } else {\n                camera = new PerspectiveCamera(\n                  75,\n                  size.width / size.height ?? 0,\n                  0.1,\n                  1000\n                );\n              }\n\n              camera.position.z = 5;\n\n              applyProps(camera, cameraOptions as UnknownRecord);\n              // Update projection matrix after applying props\n              camera.updateProjectionMatrix();\n            }\n\n            // look at center by default\n            camera.lookAt(0, 0, 0);\n\n            this.patchState({ camera });\n            this.setViewport();\n          }\n        )\n      )\n  );\n\n  readonly initRaycasterEffect = this.effect<RaycasterOptions | undefined>(\n    (raycasterOptions$) =>\n      raycasterOptions$.pipe(\n        tap((raycasterOptions: RaycasterOptions | undefined) => {\n          const raycaster = new Raycaster() as ThreeRaycaster;\n          raycaster.enabled = true;\n          applyProps(\n            raycaster as unknown as ThreeInstance,\n            raycasterOptions as UnknownRecord\n          );\n          this.patchState({ raycaster });\n        })\n      )\n  );\n\n  readonly windowResizeEffect = this.effect<WindowResizeEffectParams>(\n    (params$) =>\n      params$.pipe(\n        withLatestFrom(\n          this.renderer$ as Observable<WebGLRenderer>,\n          this.camera$ as Observable<ThreeCameraAlias>\n        ),\n        tap(\n          ([{ dpr, size }, renderer, camera]: [\n            WindowResizeEffectParams,\n            WebGLRenderer,\n            ThreeCameraAlias\n          ]) => {\n            if (camera.type === 'PerspectiveCamera') {\n              camera.aspect = size.width / size.height;\n            } else {\n              camera.left = size.width / -2;\n              camera.right = size.width / 2;\n              camera.top = size.height / 2;\n              camera.bottom = size.height / -2;\n            }\n            camera.updateProjectionMatrix();\n            camera.updateMatrixWorld();\n\n            renderer.setPixelRatio(dpr);\n            renderer.setSize(size.width, size.height);\n            this.setSize(size);\n            this.setDpr(dpr);\n            this.setViewport();\n          }\n        )\n      )\n  );\n\n  ngOnDestroy() {\n    const { renderer } = this.getImperativeState();\n    if (renderer) {\n      renderer.renderLists.dispose();\n      renderer.forceContextLoss();\n    }\n    super.ngOnDestroy();\n  }\n}\n","import { Injectable } from '@angular/core';\nimport type { BufferGeometry, Material } from 'three';\nimport type { InstancesStoreState, ThreeInstance } from '../typings';\nimport { ImperativeComponentStore } from './imperative-component-store.abstract';\n\n@Injectable()\nexport class InstancesStore extends ImperativeComponentStore<InstancesStoreState> {\n  constructor() {\n    super({ materials: {}, bufferGeometries: {}, objects: {} });\n  }\n\n  readonly saveMaterial = this.updater<{\n    material: Material;\n    id?: string;\n  }>((state, { material, id = material.uuid }) => ({\n    ...state,\n    materials: { ...state.materials, [id]: material },\n  }));\n\n  readonly removeMaterial = this.updater<string>((state, id) => {\n    const { [id]: _, ...materials } = state.materials;\n\n    return {\n      ...state,\n      materials,\n    };\n  });\n\n  readonly saveBufferGeometry = this.updater<{\n    bufferGeometry: BufferGeometry;\n    id?: string;\n  }>((state, { bufferGeometry, id = bufferGeometry.uuid }) => ({\n    ...state,\n    bufferGeometries: { ...state.bufferGeometries, [id]: bufferGeometry },\n  }));\n\n  readonly removeBufferGeometry = this.updater<string>((state, id) => {\n    const { [id]: _, ...bufferGeometries } = state.bufferGeometries;\n\n    return {\n      ...state,\n      bufferGeometries,\n    };\n  });\n\n  readonly saveObject = this.updater<ThreeInstance>((state, obj) => ({\n    ...state,\n    objects: { ...state.objects, [obj.uuid]: obj },\n  }));\n\n  readonly removeObject = this.updater<string>((state, id) => {\n    const { [id]: _, ...objects } = state.objects;\n    return { ...state, objects };\n  });\n}\n","import { Injectable, OnDestroy } from '@angular/core';\nimport { tap } from 'rxjs/operators';\nimport type { Object3D } from 'three';\nimport type {\n  EventsStoreState,\n  ThreeDomEvent,\n  ThreeIntersection,\n} from '../typings';\nimport { createEvents } from '../utils';\nimport { CanvasStore } from './canvas.store';\nimport { ImperativeComponentStore } from './imperative-component-store.abstract';\nimport { InstancesStore } from './instances.store';\n\nconst events = {\n  click: false,\n  contextmenu: false,\n  dblclick: false,\n  wheel: true,\n  pointerdown: true,\n  pointerup: true,\n  pointerleave: true,\n  pointermove: true,\n  pointercancel: true,\n  lostpointercapture: true,\n} as const;\n\n@Injectable()\nexport class EventsStore\n  extends ImperativeComponentStore<EventsStoreState>\n  implements OnDestroy\n{\n  constructor(\n    private readonly canvasStore: CanvasStore,\n    private readonly instancesStore: InstancesStore\n  ) {\n    super({\n      connected: false,\n      internal: {\n        interaction: [],\n        hovered: new Map<string, ThreeDomEvent>(),\n        capturedMap: new Map<number, Map<Object3D, ThreeIntersection>>(),\n        initialClick: [0, 0],\n        initialHits: [],\n      },\n    });\n    this.initHandlersEffect();\n  }\n\n  readonly initHandlersEffect = this.effect((trigger$) =>\n    trigger$.pipe(\n      tap(() => {\n        const { handlePointer } = createEvents(\n          () => this.canvasStore.getImperativeState(),\n          () => this.getImperativeState(),\n          () => this.instancesStore.getImperativeState()\n        );\n        this.patchState({\n          handlers: Object.keys(events).reduce(\n            (handlers, supportedEventName) => {\n              handlers[supportedEventName] = handlePointer(supportedEventName);\n              return handlers;\n            },\n            {} as Record<string, unknown>\n          ) as EventsStoreState['handlers'],\n        });\n      })\n    )\n  );\n\n  readonly connectEffect = this.effect<HTMLElement>((target$) =>\n    target$.pipe(\n      tap((target: HTMLElement) => {\n        this.disconnectEffect();\n        const { handlers } = this.getImperativeState();\n        this.patchState({ connected: target });\n        Object.entries(handlers ?? []).forEach(([name, event]) => {\n          const passive = events[name as keyof typeof events];\n          target.addEventListener(name, event, { passive });\n        });\n      })\n    )\n  );\n\n  readonly disconnectEffect = this.effect((trigger$) =>\n    trigger$.pipe(\n      tap(() => {\n        const { handlers, connected } = this.getImperativeState();\n        if (connected) {\n          Object.entries(handlers ?? []).forEach(([name, event]) => {\n            if (connected instanceof HTMLElement) {\n              connected.removeEventListener(name, event);\n            }\n          });\n\n          this.patchState({ connected: false });\n        }\n      })\n    )\n  );\n\n  ngOnDestroy() {\n    this.disconnectEffect();\n    super.ngOnDestroy();\n  }\n}\n","import { Injectable, OnDestroy } from '@angular/core';\nimport { Clock } from 'three';\nimport { AnimationStore, CanvasStore } from '../stores';\n\n@Injectable()\nexport class LoopService implements OnDestroy {\n  private readonly loopClock = new Clock();\n  // TODO: rethink limit 60fps\n  // private readonly interval = 1 / 60; // 60fps;\n  // private internalDelta = 0;\n\n  constructor(\n    private readonly canvasStore: CanvasStore,\n    private readonly animationStore: AnimationStore\n  ) {}\n\n  start() {\n    const { renderer } = this.canvasStore.getImperativeState();\n    if (renderer) {\n      renderer.setAnimationLoop(() => {\n        this.tick(this.loopClock.getDelta());\n      });\n    }\n  }\n\n  stop() {\n    const { renderer } = this.canvasStore.getImperativeState();\n    if (renderer) {\n      renderer.setAnimationLoop(null);\n    }\n  }\n\n  private tick(delta: number) {\n    // this.internalDelta += delta;\n    //\n    // if (this.internalDelta >= this.interval) {\n    //   const {\n    //     renderer,\n    //     scene,\n    //     camera,\n    //     internal: { size, viewport },\n    //     clock,\n    //     mouse,\n    //   } = this.canvasStore.getImperativeState();\n    //   const { animationCallbacks, hasPriority } =\n    //     this.animationStore.getImperativeState();\n    //\n    //   if (renderer && scene && camera) {\n    //     if (hasPriority) {\n    //       animationCallbacks.sort(\n    //         ({ priority: a = 0 }, { priority: b = 0 }) => a - b\n    //       );\n    //     } else {\n    //       renderer.render(scene, camera);\n    //     }\n    //\n    //     const renderState = {\n    //       clock,\n    //       camera,\n    //       scene,\n    //       renderer,\n    //       mouse,\n    //       size,\n    //       viewport,\n    //       delta,\n    //     };\n    //     for (const animationCallback of animationCallbacks) {\n    //       if (animationCallback.obj) {\n    //         animationCallback.callback(animationCallback.obj, renderState);\n    //       } else {\n    //         animationCallback.callback(renderState);\n    //       }\n    //     }\n    //   }\n    //\n    //   this.internalDelta = this.internalDelta % this.interval;\n    // }\n    const {\n      renderer,\n      scene,\n      camera,\n      internal: { size, viewport },\n      clock,\n      mouse,\n    } = this.canvasStore.getImperativeState();\n    const { animationCallbacks, hasPriority } =\n      this.animationStore.getImperativeState();\n\n    if (renderer && scene && camera) {\n      if (hasPriority) {\n        animationCallbacks.sort(\n          ({ priority: a = 0 }, { priority: b = 0 }) => a - b\n        );\n      } else {\n        renderer.render(scene, camera);\n      }\n\n      const renderState = {\n        clock,\n        camera,\n        scene,\n        renderer,\n        mouse,\n        size,\n        viewport,\n        delta,\n      };\n      for (const animationCallback of animationCallbacks) {\n        if (animationCallback.obj) {\n          animationCallback.callback(animationCallback.obj, renderState);\n        } else {\n          animationCallback.callback(renderState);\n        }\n      }\n    }\n  }\n\n  ngOnDestroy() {\n    this.stop();\n  }\n}\n","import { Injectable, OnDestroy } from '@angular/core';\nimport { Subject } from 'rxjs';\n\n@Injectable()\nexport class DestroyedService extends Subject<void> implements OnDestroy {\n  ngOnDestroy() {\n    this.next();\n    this.complete();\n  }\n}\n","import { Injectable, OnDestroy } from '@angular/core';\nimport { defer, forkJoin, Observable, of, shareReplay, throwError } from 'rxjs';\nimport { catchError, map, tap } from 'rxjs/operators';\nimport type { Material, Object3D, Scene } from 'three';\nimport type { GLTF } from 'three/examples/jsm/loaders/GLTFLoader';\nimport type {\n  BranchingReturn,\n  LoaderExtensions,\n  ThreeLoaderResult,\n  ThreeObjectMap,\n  UnknownRecord,\n} from '../typings';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class LoaderService implements OnDestroy {\n  private readonly cached = new Map<string, BranchingReturn>();\n\n  use<TReturnType, TUrl extends string | string[]>(\n    loaderConstructor: new () => ThreeLoaderResult<TReturnType>,\n    input: TUrl,\n    extensions?: LoaderExtensions,\n    onProgress?: (event: ProgressEvent) => void\n  ): TUrl extends any[]\n    ? Observable<BranchingReturn<TReturnType, GLTF, GLTF & ThreeObjectMap>[]>\n    : Observable<BranchingReturn<TReturnType, GLTF, GLTF & ThreeObjectMap>> {\n    const keys = (Array.isArray(input) ? input : [input]) as string[];\n    const loader = new loaderConstructor();\n    if (extensions) {\n      extensions(loader);\n    }\n\n    const results$ = forkJoin(\n      keys.map((key) => {\n        if (this.cached.has(key)) {\n          return of(this.cached.get(key));\n        }\n\n        return defer(() => loader.loadAsync(key, onProgress)).pipe(\n          tap((data) => {\n            if (data.scene) {\n              Object.assign(data, this.buildGraph(data.scene as Scene));\n            }\n            this.cached.set(key, data);\n          }),\n          catchError((err) => {\n            console.error(`Error loading ${key}: ${err.message}`);\n            return throwError(err);\n          })\n        );\n      })\n    ) as Observable<\n      BranchingReturn<TReturnType, GLTF, GLTF & ThreeObjectMap>[]\n    >;\n\n    return defer(() =>\n      Array.isArray(input)\n        ? results$\n        : results$.pipe(map((results) => results[0]))\n    ).pipe(shareReplay({ bufferSize: 1, refCount: true })) as TUrl extends any[]\n      ? Observable<BranchingReturn<TReturnType, GLTF, GLTF & ThreeObjectMap>[]>\n      : Observable<BranchingReturn<TReturnType, GLTF, GLTF & ThreeObjectMap>>;\n  }\n\n  ngOnDestroy() {\n    this.cached.clear();\n  }\n\n  private buildGraph(object: Object3D): ThreeObjectMap {\n    const data: ThreeObjectMap = { nodes: {}, materials: {} };\n    if (object) {\n      object.traverse((obj) => {\n        if (obj.name) {\n          data.nodes[obj.name] = obj;\n        }\n        if (\n          (obj as unknown as UnknownRecord).material &&\n          !data.materials[\n            (\n              (obj as unknown as UnknownRecord)\n                .material as unknown as UnknownRecord\n            ).name as string\n          ]\n        ) {\n          data.materials[\n            (\n              (obj as unknown as UnknownRecord)\n                .material as unknown as UnknownRecord\n            ).name as string\n          ] = (obj as unknown as UnknownRecord).material as Material;\n        }\n      });\n    }\n    return data;\n  }\n}\n","import { DOCUMENT } from '@angular/common';\nimport {\n  ChangeDetectionStrategy,\n  Component,\n  ElementRef,\n  EventEmitter,\n  HostBinding,\n  Inject,\n  Input,\n  NgZone,\n  OnInit,\n  Output,\n  Self,\n  ViewChild,\n} from '@angular/core';\nimport { asapScheduler, fromEvent } from 'rxjs';\nimport { observeOn, takeUntil } from 'rxjs/operators';\nimport type { Scene, WebGLRenderer, WebGLShadowMap } from 'three';\nimport { DestroyedService, LoopService } from './services';\nimport {\n  AnimationStore,\n  CanvasStore,\n  EventsStore,\n  InstancesStore,\n} from './stores';\nimport type {\n  CameraOptions,\n  RaycasterOptions,\n  SceneOptions,\n  ThreeCameraAlias,\n} from './typings';\n\n@Component({\n  selector: 'ngt-canvas',\n  exportAs: 'ngtCanvas',\n  template: ` <canvas #rendererCanvas></canvas> `,\n  styles: [\n    `\n      :host {\n        display: block;\n        position: relative;\n        width: 100%;\n        height: 100%;\n        overflow: hidden;\n      }\n\n      :host canvas {\n        display: block;\n      }\n    `,\n  ],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  providers: [\n    CanvasStore,\n    EventsStore,\n    InstancesStore,\n    AnimationStore,\n    LoopService,\n    DestroyedService,\n  ],\n})\nexport class CanvasComponent implements OnInit {\n  @HostBinding('class.ngt-canvas') hostClass = true;\n\n  @Input() set orthographic(v: boolean) {\n    this.canvasStore.setIsOrthographic(v);\n  }\n\n  @Input() set linear(v: boolean) {\n    this.canvasStore.setIsLinear(v);\n  }\n\n  @Input() set shadows(v: boolean | Partial<WebGLShadowMap>) {\n    this.canvasStore.setShadows(v);\n  }\n\n  @Input() camera?: CameraOptions;\n  @Input() scene?: SceneOptions;\n  @Input() raycaster?: RaycasterOptions = {};\n\n  @Output() created = new EventEmitter<{\n    gl: WebGLRenderer;\n    camera: ThreeCameraAlias;\n    scene: Scene;\n  }>();\n\n  @ViewChild('rendererCanvas', { static: true })\n  rendererCanvas!: ElementRef<HTMLCanvasElement>;\n\n  constructor(\n    @Self() private readonly canvasStore: CanvasStore,\n    @Self() private readonly animationStore: AnimationStore,\n    @Self() private readonly eventsStore: EventsStore,\n    @Self() private readonly loopService: LoopService,\n    private readonly ngZone: NgZone,\n    private readonly hostElement: ElementRef<HTMLElement>,\n    @Inject(DOCUMENT) private readonly document: Document,\n    private readonly destroyed: DestroyedService\n  ) {}\n\n  ngOnInit(): void {\n    this.ngZone.runOutsideAngular(() => {\n      this.canvasStore.setSize({\n        width: this.hostElement.nativeElement.clientWidth,\n        height: this.hostElement.nativeElement.clientHeight,\n      });\n\n      this.canvasStore.setDpr(\n        (this.document as Document).defaultView?.devicePixelRatio || 1\n      );\n\n      this.canvasStore.initRendererEffect(this.rendererCanvas.nativeElement);\n      this.canvasStore.initSceneEffect(this.scene);\n      this.canvasStore.initCameraEffect(this.camera);\n      this.canvasStore.initRaycasterEffect(this.raycaster);\n\n      this.initWindowResizeListener();\n      this.initActiveListener();\n    });\n  }\n\n  private initWindowResizeListener() {\n    if (this.document?.defaultView) {\n      fromEvent(this.document.defaultView, 'resize')\n        .pipe(takeUntil(this.destroyed))\n        .subscribe(() => {\n          this.ngZone.runOutsideAngular(() => {\n            this.canvasStore.windowResizeEffect({\n              size: {\n                width: this.hostElement.nativeElement.clientWidth,\n                height: this.hostElement.nativeElement.clientHeight,\n              },\n              dpr:\n                (this.document as Document).defaultView?.devicePixelRatio || 1,\n            });\n          });\n        });\n    }\n  }\n\n  private initActiveListener() {\n    this.canvasStore.active$\n      .pipe(takeUntil(this.destroyed), observeOn(asapScheduler))\n      .subscribe((active) => {\n        this.ngZone.runOutsideAngular(() => {\n          if (active) {\n            const { renderer, camera, scene } =\n              this.canvasStore.getImperativeState();\n            if (renderer && camera && scene) {\n              this.created.emit({ gl: renderer, camera, scene });\n              this.eventsStore.connectEffect(renderer.domElement);\n              this.loopService.start();\n            }\n          }\n        });\n      });\n  }\n}\n","import { Directive, OnChanges, SimpleChanges } from '@angular/core';\nimport { ReplaySubject } from 'rxjs';\n\n@Directive()\nexport abstract class Controller implements OnChanges {\n  readonly change$ = new ReplaySubject<SimpleChanges>(1);\n\n  ngOnChanges(changes: SimpleChanges) {\n    this.change$.next(changes);\n  }\n}\n","// GENERATED\n\nimport { Directive, EventEmitter, Input, Output } from '@angular/core';\nimport { Object3D } from 'three';\nimport {\n  ThreeColor,\n  ThreeEuler,\n  ThreeEvent,\n  ThreeQuaternion,\n  ThreeVector3,\n  UnknownRecord,\n} from '../typings';\nimport { Controller } from './controller.abstract';\n\n@Directive({\n  selector: `\n    ngt-primitive[o3d],\n    ngt-mesh[o3d],\n    ngt-instanced-mesh[o3d],\n    ngt-skinned-mesh[o3d],\n    ngt-bone[o3d],\n    ngt-group[o3d],\n    ngt-lod[o3d],\n    ngt-scene[o3d],\n    ngt-points[o3d],\n    ngt-cube-camera[o3d],\n    ngt-contact-shadows[o3d],\n    ngt-html[o3d],\n    ngt-light-probe[o3d],\n    ngt-ambient-light[o3d],\n    ngt-ambient-light-probe[o3d],\n    ngt-hemisphere-light[o3d],\n    ngt-hemisphere-light-probe[o3d],\n    ngt-directional-light[o3d],\n    ngt-point-light[o3d],\n    ngt-spot-light[o3d],\n    ngt-rect-area-light[o3d],\n    ngt-arrow-helper[o3d],\n    ngt-axes-helper[o3d],\n    ngt-box-helper[o3d],\n    ngt-box3-helper[o3d],\n    ngt-grid-helper[o3d],\n    ngt-camera-helper[o3d],\n    ngt-directional-light-helper[o3d],\n    ngt-hemisphere-light-helper[o3d],\n    ngt-plane-helper[o3d],\n    ngt-point-light-helper[o3d],\n    ngt-polar-grid-helper[o3d],\n    ngt-skeleton-helper[o3d],\n    ngt-spot-light-helper[o3d],\n    ngt-line[o3d],\n    ngt-line-loop[o3d],\n    ngt-line-segments[o3d],\n    ngt-sprite[o3d],\n    ngt-camera[o3d],\n    ngt-perspective-camera[o3d],\n    ngt-orthographic-camera[o3d],\n    ngt-array-camera[o3d],\n    ngt-stereo-camera[o3d]\n  `,\n  exportAs: 'ngtObject3dController',\n})\nexport class Object3dControllerDirective extends Controller {\n  @Input() name?: string;\n  @Input() position?: ThreeVector3;\n  @Input() rotation?: ThreeEuler;\n  @Input() quaternion?: ThreeQuaternion;\n  @Input() scale?: ThreeVector3;\n  @Input() color?: ThreeColor;\n  @Input() userData?: UnknownRecord;\n  @Input() dispose?: () => void;\n  @Input() castShadow = false;\n  @Input() receiveShadow = false;\n  @Input() visible = true;\n  @Input() matrixAutoUpdate = true;\n\n  @Input() appendMode: 'immediate' | 'root' = 'immediate';\n  @Input() appendTo?: Object3D;\n\n  // events\n  @Output() click = new EventEmitter<ThreeEvent<MouseEvent>>();\n  @Output() contextmenu = new EventEmitter<ThreeEvent<MouseEvent>>();\n  @Output() dblclick = new EventEmitter<ThreeEvent<MouseEvent>>();\n  @Output() pointerup = new EventEmitter<ThreeEvent<PointerEvent>>();\n  @Output() pointerdown = new EventEmitter<ThreeEvent<PointerEvent>>();\n  @Output() pointerover = new EventEmitter<ThreeEvent<PointerEvent>>();\n  @Output() pointerout = new EventEmitter<ThreeEvent<PointerEvent>>();\n  @Output() pointerenter = new EventEmitter<ThreeEvent<PointerEvent>>();\n  @Output() pointerleave = new EventEmitter<ThreeEvent<PointerEvent>>();\n  @Output() pointermove = new EventEmitter<ThreeEvent<PointerEvent>>();\n  @Output() pointermissed = new EventEmitter<ThreeEvent<PointerEvent>>();\n  @Output() pointercancel = new EventEmitter<ThreeEvent<PointerEvent>>();\n  @Output() wheel = new EventEmitter<ThreeEvent<WheelEvent>>();\n}\n","import { NgModule } from '@angular/core';\nimport { CanvasComponent } from './canvas.component';\nimport { Object3dControllerDirective } from './controllers';\n\n@NgModule({\n  declarations: [CanvasComponent, Object3dControllerDirective],\n  exports: [CanvasComponent, Object3dControllerDirective],\n})\nexport class ThreeCoreModule {}\n","import {\n  ChangeDetectorRef,\n  InjectionToken,\n  Optional,\n  Provider,\n} from '@angular/core';\nimport { takeUntil } from 'rxjs/operators';\nimport { Object3dControllerDirective } from '../controllers';\nimport { DestroyedService } from '../services';\n\nexport const OBJECT_3D_WATCHED_CONTROLLER = new InjectionToken(\n  'Watched Object3D Controller'\n);\n\nexport const OBJECT_3D_CONTROLLER_PROVIDER: Provider[] = [\n  DestroyedService,\n  {\n    provide: OBJECT_3D_WATCHED_CONTROLLER,\n    deps: [\n      [new Optional(), Object3dControllerDirective],\n      ChangeDetectorRef,\n      DestroyedService,\n    ],\n    useFactory: object3dWatchedControllerFactory,\n  },\n];\n\nexport function object3dWatchedControllerFactory(\n  controller: Object3dControllerDirective | null,\n  changeDetectorRef: ChangeDetectorRef,\n  destroy$: DestroyedService\n) {\n  if (!controller) return null;\n\n  controller.change$.pipe(takeUntil(destroy$)).subscribe(() => {\n    changeDetectorRef.markForCheck();\n  });\n\n  return controller;\n}\n","import {\n  Directive,\n  EventEmitter,\n  NgZone,\n  OnDestroy,\n  Output,\n} from '@angular/core';\nimport { Object3D } from 'three';\nimport { AnimationStore } from '../stores';\nimport type { AnimationReady } from '../typings';\n\n@Directive()\nexport abstract class AnimationLoopParticipant<TObject = unknown>\n  implements OnDestroy\n{\n  @Output() animateReady = new EventEmitter<AnimationReady<TObject>>();\n\n  private animateTeardown?: () => void;\n\n  protected constructor(\n    protected readonly animationStore: AnimationStore,\n    protected readonly ngZone: NgZone\n  ) {}\n\n  protected participate(animateObject: TObject) {\n    this.ngZone.runOutsideAngular(() => {\n      if (this.animateReady.observed) {\n        if (animateObject instanceof Object3D) {\n          this.animateTeardown = this.animationStore.registerAnimation(\n            animateObject as Object3D,\n            (obj, state) => {\n              this.animateReady.emit({\n                animateObject: obj as unknown as TObject,\n                renderState: state,\n              });\n            }\n          );\n        } else {\n          this.animateTeardown = this.animationStore.registerAnimation(\n            (state) => {\n              this.animateReady.emit({\n                animateObject,\n                renderState: state,\n              });\n            }\n          );\n        }\n      }\n    });\n  }\n\n  ngOnDestroy() {\n    this.ngZone.runOutsideAngular(() => {\n      if (this.animateTeardown) {\n        this.animateTeardown();\n      }\n    });\n  }\n}\n","import {\n  Directive,\n  Inject,\n  NgZone,\n  OnChanges,\n  OnDestroy,\n  Optional,\n  Output,\n  SkipSelf,\n} from '@angular/core';\nimport { BehaviorSubject, Observable, Subscription } from 'rxjs';\nimport { filter, take } from 'rxjs/operators';\nimport type { Object3D } from 'three';\nimport { Color } from 'three';\nimport { Object3dControllerDirective } from '../controllers';\nimport { OBJECT_3D_WATCHED_CONTROLLER } from '../di';\nimport {\n  AnimationStore,\n  CanvasStore,\n  EventsStore,\n  InstancesStore,\n} from '../stores';\nimport type {\n  EventHandlers,\n  InstanceInternal,\n  ThreeEvent,\n  ThreeInstance,\n  UnknownRecord,\n} from '../typings';\nimport { applyProps } from '../utils';\nimport { AnimationLoopParticipant } from './animation-loop-participant.abstract';\n\n@Directive()\nexport abstract class ThreeObject3d<TObject extends Object3D = Object3D>\n  extends AnimationLoopParticipant<TObject>\n  implements OnDestroy, OnChanges\n{\n  private $object3d = new BehaviorSubject<TObject | null>(null);\n\n  get object3d$(): Observable<TObject | null> {\n    return this.$object3d.asObservable();\n  }\n\n  @Output() ready = this.object3d$.pipe(filter(Boolean)) as Observable<TObject>;\n\n  private changesSubscription?: Subscription;\n\n  constructor(\n    @Inject(OBJECT_3D_WATCHED_CONTROLLER)\n    protected readonly object3dController: Object3dControllerDirective,\n    protected readonly canvasStore: CanvasStore,\n    protected readonly instancesStore: InstancesStore,\n    protected readonly eventsStore: EventsStore,\n    readonly animationStore: AnimationStore,\n    readonly ngZone: NgZone,\n    @Optional()\n    @SkipSelf()\n    protected readonly parentObjectDirective?: ThreeObject3d\n  ) {\n    super(animationStore, ngZone);\n\n    this.changesSubscription = object3dController.change$.subscribe(() => {\n      if (this.object3d) {\n        this.applyCustomProps();\n      }\n      if (this.inputChangeHandler) {\n        this.inputChangeHandler();\n      }\n    });\n  }\n\n  ngOnChanges() {\n    if (this.object3d) {\n      this.applyCustomProps();\n    }\n  }\n\n  protected init() {\n    this.ngZone.runOutsideAngular(() => {\n      this.initObject();\n\n      if (this.object3d) {\n        this.applyCustomProps();\n\n        applyProps(this.object3d, {\n          __ngt: {\n            canvasStateGetter: () => this.canvasStore.getImperativeState(),\n            eventsStateGetter: () => this.eventsStore.getImperativeState(),\n            handlers: this.applyEvents(),\n          } as InstanceInternal,\n        });\n\n        this.instancesStore.saveObject(\n          this.object3d as unknown as ThreeInstance\n        );\n\n        this.appendToParent();\n        this.objectReady();\n      }\n    });\n  }\n\n  protected addToScene() {\n    const { scene } = this.canvasStore.getImperativeState();\n    if (scene) {\n      scene.add(this.object3d);\n    }\n  }\n\n  protected addToParent() {\n    if (this.parentObjectDirective) {\n      this.parentObjectDirective.object3d.add(this.object3d);\n    } else {\n      this.addToScene();\n    }\n  }\n\n  protected remove() {\n    if (this.object3dController.appendTo) {\n      this.object3dController.appendTo.remove(this.object3d);\n    } else if (\n      this.parentObjectDirective &&\n      this.object3dController.appendMode === 'immediate'\n    ) {\n      this.parentObjectDirective.object3d.remove(this.object3d);\n    } else {\n      const { scene } = this.canvasStore.getImperativeState();\n      if (scene) {\n        scene.remove(this.object3d);\n      }\n    }\n\n    this.object3d.clear();\n  }\n\n  protected objectReady() {\n    this.$object3d.next(this.object3d);\n    this.participate(this.object3d);\n  }\n\n  protected inputChangeHandler?: () => void;\n\n  private applyCustomProps() {\n    this.ngZone.runOutsideAngular(() => {\n      const customProps = {\n        castShadow: this.object3dController.castShadow,\n        receiveShadow: this.object3dController.receiveShadow,\n        visible: this.object3dController.visible,\n        matrixAutoUpdate: this.object3dController.matrixAutoUpdate,\n      } as UnknownRecord;\n\n      if (this.object3dController.name) {\n        customProps['name'] = this.object3dController.name;\n      }\n\n      if (this.object3dController.position) {\n        customProps['position'] = this.object3dController.position;\n      }\n\n      if (this.object3dController.rotation) {\n        customProps['rotation'] = this.object3dController.rotation;\n      } else if (this.object3dController.quaternion) {\n        customProps['quaternion'] = this.object3dController.quaternion;\n      }\n\n      if (this.object3dController.scale) {\n        customProps['scale'] = this.object3dController.scale;\n      }\n\n      if (this.object3dController.userData) {\n        customProps['userData'] = this.object3dController.userData;\n      }\n\n      if (this.object3dController.color) {\n        this.object3dController.color = Array.isArray(\n          this.object3dController.color\n        )\n          ? new Color(...this.object3dController.color)\n          : new Color(this.object3dController.color);\n        if (!this.canvasStore.getImperativeState().isLinear) {\n          this.object3dController.color.convertSRGBToLinear();\n        }\n        customProps['color'] = this.object3dController.color;\n      }\n\n      if (this.object3dController.dispose) {\n        customProps['dispose'] = this.object3dController.dispose;\n      }\n\n      this.object3dController.change$.pipe(take(1)).subscribe((changes) => {\n        if (changes) {\n          for (const [inputName, inputChange] of Object.entries(changes)) {\n            if (\n              !inputChange.isFirstChange() ||\n              [\n                'name',\n                'position',\n                'rotation',\n                'quaternion',\n                'scale',\n                'userData',\n                'color',\n                'dispose',\n                'castShadow',\n                'receiveShadow',\n                'visible',\n                'matrixAutoUpdate',\n              ].includes(inputName) // skip 12 common inputs\n            ) {\n              continue;\n            }\n            customProps[inputName] = inputChange.currentValue;\n          }\n        }\n      });\n\n      applyProps(this.object3d, customProps);\n      this.object3d.updateMatrix();\n    });\n  }\n\n  private applyEvents(): EventHandlers {\n    const handlers: EventHandlers = {};\n\n    (\n      [\n        'click',\n        'contextmenu',\n        'dblclick',\n        'pointerup',\n        'pointerdown',\n        'pointerover',\n        'pointerout',\n        'pointerenter',\n        'pointerleave',\n        'pointermove',\n        'pointermissed',\n        'pointercancel',\n        'wheel',\n      ] as const\n    ).forEach((eventName) => {\n      if (this.object3dController[eventName].observed) {\n        handlers[eventName] = (\n          event: Parameters<\n            Exclude<EventHandlers[typeof eventName], undefined>\n          >[0]\n        ) => {\n          this.ngZone.run(() => {\n            this.object3dController[eventName].emit(event as ThreeEvent<any>);\n          });\n        };\n      }\n    });\n\n    return handlers;\n  }\n\n  private appendToParent(): void {\n    if (this.object3dController.appendTo) {\n      this.object3dController.appendTo.add(this.object3d);\n      return;\n    }\n\n    if (this.object3dController.appendMode === 'root') {\n      this.addToScene();\n      return;\n    }\n\n    if (this.object3dController.appendMode === 'immediate') {\n      this.addToParent();\n    }\n  }\n\n  ngOnDestroy(): void {\n    super.ngOnDestroy();\n    if (this.changesSubscription) {\n      this.changesSubscription.unsubscribe();\n    }\n    this.ngZone.runOutsideAngular(() => {\n      if (this.object3d) {\n        this.remove();\n        this.instancesStore.removeObject(this.object3d.uuid);\n        this.animationStore.unregisterAnimationEffect(this.object3d.uuid);\n      }\n    });\n  }\n\n  protected abstract initObject(): void;\n\n  abstract get object3d(): TObject;\n}\n","import { AfterContentInit, Directive, Input } from '@angular/core';\nimport { BufferGeometry, Material, Object3D } from 'three';\nimport { AnyConstructor, UnknownRecord } from '../typings';\nimport { ThreeObject3d } from './object-3d.abstract';\n\n@Directive()\nexport abstract class ThreeObject3dMaterialGeometry<\n    TObject extends Object3D = Object3D\n  >\n  extends ThreeObject3d<TObject>\n  implements AfterContentInit\n{\n  abstract get objectType(): AnyConstructor<TObject>;\n\n  @Input() geometry?: string | BufferGeometry | null;\n  @Input() material?: string | string[] | Material | Material[] | null;\n  @Input() morphTargetInfluences?: number[];\n  @Input() morphTargetDictionary?: { [key: string]: number };\n\n  private _objectMaterialGeometry!: TObject;\n\n  private _extraArgs?: unknown[];\n  set extraArgs(v: unknown[]) {\n    this._extraArgs = v;\n  }\n\n  ngAfterContentInit() {\n    this.init();\n  }\n\n  protected initObject() {\n    if (this.canCreate()) {\n      const material = this.getMaterial();\n      const geometry = this.getGeometry();\n\n      this._objectMaterialGeometry = new this.objectType(\n        geometry,\n        material,\n        ...(this._extraArgs || [])\n      );\n\n      if (\n        this.morphTargetDictionary &&\n        'morphTargetDictionary' in this._objectMaterialGeometry\n      ) {\n        (this._objectMaterialGeometry as UnknownRecord).morphTargetDictionary =\n          this.morphTargetDictionary;\n      }\n\n      if (\n        this.morphTargetInfluences &&\n        'morphTargetInfluences' in this._objectMaterialGeometry\n      ) {\n        (this._objectMaterialGeometry as UnknownRecord).morphTargetInfluences =\n          this.morphTargetInfluences;\n      }\n\n      if (this.customize) {\n        this.customize();\n      }\n    }\n  }\n\n  protected customize?: () => void;\n\n  protected canCreate() {\n    return true;\n  }\n\n  get object3d(): TObject {\n    return this._objectMaterialGeometry;\n  }\n\n  private getMaterial(): Material[] | Material | undefined {\n    if (this.material) {\n      if (\n        (Array.isArray(this.material) &&\n          this.material[0] instanceof Material) ||\n        this.material instanceof Material\n      ) {\n        return this.material as Material | Material[];\n      }\n\n      if (Array.isArray(this.material)) {\n        return (this.material as string[]).map(\n          (materialId) =>\n            this.instancesStore.getImperativeState().materials[materialId]\n        );\n      }\n\n      return this.instancesStore.getImperativeState().materials[this.material];\n    }\n\n    return undefined;\n  }\n\n  private getGeometry(): BufferGeometry | undefined {\n    if (this.geometry) {\n      if (this.geometry instanceof BufferGeometry) {\n        return this.geometry;\n      }\n\n      return this.instancesStore.getImperativeState().bufferGeometries[\n        this.geometry\n      ];\n    }\n    return undefined;\n  }\n}\n","import {\n  Directive,\n  Input,\n  NgZone,\n  OnDestroy,\n  OnInit,\n  SkipSelf,\n} from '@angular/core';\nimport { Color, Material, MaterialParameters } from 'three';\nimport { CanvasStore, InstancesStore } from '../stores';\nimport type { AnyConstructor, ThreeColor, UnknownRecord } from '../typings';\n\n@Directive()\nexport abstract class ThreeMaterial<\n  TMaterial extends Material = Material,\n  TMaterialParameters extends MaterialParameters = MaterialParameters\n> implements OnInit, OnDestroy\n{\n  @Input() ngtId?: string;\n\n  @Input() set parameters(v: TMaterialParameters | undefined) {\n    this._parameters = v;\n    if (v && this.material) {\n      this.ngZone.runOutsideAngular(() => {\n        this.convertColorToLinear(v);\n        this.material.setValues(v);\n        this.material.needsUpdate = true;\n      });\n    }\n  }\n\n  get parameters(): TMaterialParameters | undefined {\n    return this._parameters;\n  }\n\n  private _parameters?: TMaterialParameters;\n\n  constructor(\n    protected readonly ngZone: NgZone,\n    @SkipSelf() protected readonly instancesStore: InstancesStore,\n    @SkipSelf() protected readonly canvasStore: CanvasStore\n  ) {}\n\n  abstract materialType: AnyConstructor<TMaterial>;\n\n  ngOnInit() {\n    this.ngZone.runOutsideAngular(() => {\n      if (this.parameters) {\n        this.convertColorToLinear(this.parameters);\n      }\n      this._material = new this.materialType(this.parameters);\n      this.instancesStore.saveMaterial({\n        id: this.ngtId,\n        material: this._material,\n      });\n    });\n  }\n\n  private _material!: TMaterial;\n  get material(): TMaterial {\n    return this._material;\n  }\n\n  private convertColorToLinear(parameters: TMaterialParameters) {\n    if ('color' in parameters) {\n      const colorParams = (parameters as UnknownRecord)['color'] as ThreeColor;\n      (parameters as UnknownRecord)['color'] = Array.isArray(colorParams)\n        ? new Color(...colorParams)\n        : new Color(colorParams);\n\n      if (!this.canvasStore.getImperativeState().isLinear) {\n        ((parameters as UnknownRecord)['color'] as Color).convertSRGBToLinear();\n      }\n    }\n  }\n\n  ngOnDestroy() {\n    this.ngZone.runOutsideAngular(() => {\n      if (this.material) {\n        this.instancesStore.removeMaterial(this.ngtId || this.material.uuid);\n        this.material.dispose();\n      }\n    });\n  }\n}\n","import { Directive, NgZone, OnDestroy, OnInit } from '@angular/core';\nimport { Texture } from 'three';\nimport type { AnyConstructor } from '../typings';\n\n@Directive()\nexport abstract class ThreeTexture<TTexture extends Texture = Texture>\n  implements OnInit, OnDestroy\n{\n  abstract textureType: AnyConstructor<TTexture>;\n\n  constructor(private readonly ngZone: NgZone) {}\n\n  private _extraArgs: unknown[] = [];\n\n  protected set extraArgs(v: unknown[]) {\n    this._extraArgs = v;\n    this.ngZone.runOutsideAngular(() => {\n      this._texture = new this.textureType(...this._extraArgs);\n    });\n  }\n\n  private _texture?: TTexture;\n\n  ngOnInit() {\n    this.ngZone.runOutsideAngular(() => {\n      if (!this.texture) {\n        this._texture = new this.textureType(...this._extraArgs);\n      }\n    });\n  }\n\n  get texture(): TTexture | undefined {\n    return this._texture;\n  }\n\n  ngOnDestroy() {\n    this.ngZone.runOutsideAngular(() => {\n      if (this.texture) {\n        this.texture.dispose();\n      }\n    });\n  }\n}\n","import { Directive, Input, OnInit } from '@angular/core';\nimport { Light } from 'three';\nimport type { AnyConstructor } from '../typings';\nimport { ThreeObject3d } from './object-3d.abstract';\n\n@Directive()\nexport abstract class ThreeLight<TLight extends Light = Light>\n  extends ThreeObject3d<TLight>\n  implements OnInit\n{\n  abstract lightType: AnyConstructor<TLight>;\n\n  @Input() intensity?: number;\n\n  private _extraArgs: unknown[] = [];\n  protected set extraArgs(v: unknown[]) {\n    this._extraArgs = v;\n    this.ngZone.runOutsideAngular(() => {\n      this.init();\n    });\n  }\n\n  private _light!: TLight;\n\n  ngOnInit() {\n    if (!this.object3d) {\n      this.init();\n    }\n  }\n\n  protected initObject() {\n    if (this.intensity) {\n      this._extraArgs[1] = this.intensity;\n    }\n    this._light = new this.lightType(...this._extraArgs);\n  }\n\n  get object3d(): TLight {\n    return this._light;\n  }\n}\n","import { Directive, OnChanges, OnInit } from '@angular/core';\nimport { Object3D } from 'three';\nimport type { AnyConstructor } from '../typings';\nimport { ThreeObject3d } from './object-3d.abstract';\n\n@Directive()\nexport abstract class ThreeHelper<THelper extends Object3D>\n  extends ThreeObject3d<THelper>\n  implements OnInit, OnChanges\n{\n  abstract helperType: AnyConstructor<THelper>;\n\n  private _extraArgs: unknown[] = [];\n\n  private _helper!: THelper;\n\n  protected set extraArgs(v: unknown[]) {\n    this._extraArgs = v;\n    this.ngZone.runOutsideAngular(() => {\n      this.init();\n    });\n  }\n\n  ngOnChanges() {\n    super.ngOnChanges();\n    this.inputChangeHandler();\n  }\n\n  inputChangeHandler = () => {\n    if (!this.object3d) {\n      this.init();\n    }\n  };\n\n  ngOnInit() {\n    this.inputChangeHandler();\n  }\n\n  protected initObject() {\n    try {\n      this._helper = new this.helperType(...this._extraArgs);\n    } catch (e) {\n      console.log('Failed to initialize Helper');\n    }\n  }\n\n  get object3d(): THelper {\n    return this._helper;\n  }\n}\n","import {\n  Directive,\n  Input,\n  NgZone,\n  OnDestroy,\n  OnInit,\n  SkipSelf,\n} from '@angular/core';\nimport type { BufferGeometry } from 'three';\nimport { InstancesStore } from '../stores';\nimport type { AnyConstructor } from '../typings';\n\n@Directive()\nexport abstract class ThreeBufferGeometry<\n  TGeometry extends BufferGeometry = BufferGeometry\n> implements OnInit, OnDestroy\n{\n  @Input() ngtId?: string;\n\n  constructor(\n    @SkipSelf() protected readonly instancesStore: InstancesStore,\n    private readonly ngZone: NgZone\n  ) {}\n\n  abstract geometryType: AnyConstructor<TGeometry>;\n\n  private _extraArgs: unknown[] = [];\n  protected set extraArgs(v: unknown[]) {\n    this._extraArgs = v;\n    this.ngZone.runOutsideAngular(() => {\n      this.init();\n    });\n  }\n\n  ngOnInit() {\n    this.ngZone.runOutsideAngular(() => {\n      if (!this.bufferGeometry) {\n        this.init();\n      }\n    });\n  }\n\n  private init() {\n    this._bufferGeometry = new this.geometryType(...this._extraArgs);\n\n    this.instancesStore.saveBufferGeometry({\n      id: this.ngtId,\n      bufferGeometry: this._bufferGeometry,\n    });\n  }\n\n  private _bufferGeometry!: TGeometry;\n  get bufferGeometry(): TGeometry {\n    return this._bufferGeometry;\n  }\n\n  ngOnDestroy() {\n    this.ngZone.runOutsideAngular(() => {\n      if (this.bufferGeometry) {\n        this.instancesStore.removeBufferGeometry(\n          this.ngtId || this.bufferGeometry.uuid\n        );\n        this.bufferGeometry.dispose();\n      }\n    });\n  }\n}\n","import { Directive, Input, NgZone, OnInit, Optional } from '@angular/core';\nimport { Curve, Vector, Vector2, Vector3 } from 'three';\nimport type { AnyConstructor } from '../typings';\nimport { ThreeBufferGeometry } from './geometry.abstract';\n\n@Directive()\nexport abstract class ThreeCurve<TCurve extends Curve<Vector> = Curve<Vector>>\n  implements OnInit\n{\n  @Input() divisions?: number;\n\n  abstract curveType: AnyConstructor<TCurve>;\n\n  private _extraArgs: unknown[] = [];\n\n  protected set extraArgs(v: unknown[]) {\n    this._extraArgs = v;\n    this.ngZone.runOutsideAngular(() => {\n      this.init();\n    });\n  }\n\n  constructor(\n    private readonly ngZone: NgZone,\n    @Optional() private readonly geometryDirective?: ThreeBufferGeometry\n  ) {}\n\n  private _curve?: TCurve;\n\n  ngOnInit() {\n    this.ngZone.runOutsideAngular(() => {\n      if (!this.curve) {\n        this.init();\n      }\n    });\n  }\n\n  private init() {\n    this._curve = new this.curveType(...this._extraArgs);\n    if (this.curve && this.geometryDirective) {\n      const points = this.curve.getPoints(this.divisions);\n      this.geometryDirective.bufferGeometry.setFromPoints(\n        points as unknown as Vector3[] | Vector2[]\n      );\n    }\n  }\n\n  get curve(): TCurve | undefined {\n    return this._curve;\n  }\n}\n","import {\n  Directive,\n  Input,\n  NgZone,\n  OnChanges,\n  OnDestroy,\n  OnInit,\n  Optional,\n} from '@angular/core';\nimport type { BuiltinShaderAttributeName } from 'three';\nimport { BufferAttribute } from 'three';\nimport type { AnyConstructor } from '../typings';\nimport { ThreeBufferGeometry } from './geometry.abstract';\n\n@Directive()\nexport abstract class ThreeAttribute<\n  TAttribute extends BufferAttribute = BufferAttribute\n> implements OnInit, OnChanges, OnDestroy\n{\n  @Input() attach?: BuiltinShaderAttributeName;\n\n  abstract attributeType: AnyConstructor<TAttribute>;\n\n  constructor(\n    protected readonly ngZone: NgZone,\n    @Optional() protected readonly geometryDirective?: ThreeBufferGeometry\n  ) {}\n\n  private _extraArgs: unknown[] = [];\n\n  protected set extraArgs(v: unknown[]) {\n    this._extraArgs = v;\n    this.ngZone.runOutsideAngular(() => {\n      this.init();\n    });\n  }\n\n  private _attribute?: TAttribute;\n\n  ngOnChanges() {\n    this.ngZone.runOutsideAngular(() => {\n      if (this.attribute) {\n        this.attribute.needsUpdate = true;\n      }\n    });\n  }\n\n  ngOnInit() {\n    this.ngZone.runOutsideAngular(() => {\n      if (!this.attribute) {\n        this.init();\n      }\n    });\n  }\n\n  private init() {\n    if (this.geometryDirective && this.attach) {\n      this._attribute = new this.attributeType(...this._extraArgs);\n      if (this.attribute) {\n        this.geometryDirective.bufferGeometry.setAttribute(\n          this.attach,\n          this.attribute\n        );\n      }\n    }\n  }\n\n  ngOnDestroy() {\n    this.ngZone.runOutsideAngular(() => {\n      if (this.geometryDirective && this.attach) {\n        this.geometryDirective.bufferGeometry.deleteAttribute(this.attach);\n      }\n    });\n  }\n\n  get attribute(): TAttribute | undefined {\n    return this._attribute;\n  }\n}\n","import type { QueryList } from '@angular/core';\nimport { ContentChild, ContentChildren, Directive } from '@angular/core';\nimport { Line } from 'three';\nimport type { AnyConstructor } from '../typings';\nimport { ThreeBufferGeometry } from './geometry.abstract';\nimport { ThreeMaterial } from './material.abstract';\nimport { ThreeObject3dMaterialGeometry } from './object-3d-material-geometry.abstract';\n\n@Directive()\nexport abstract class ThreeLine<\n  TLine extends Line = Line\n> extends ThreeObject3dMaterialGeometry<TLine> {\n  @ContentChildren(ThreeMaterial) set materialDirectives(\n    v: QueryList<ThreeMaterial>\n  ) {\n    if (this.material == null && v) {\n      this.material =\n        v.length === 1\n          ? v.first.material\n          : v.toArray().map((dir) => dir.material);\n    }\n  }\n\n  @ContentChild(ThreeBufferGeometry)\n  set bufferGeometryDirective(v: ThreeBufferGeometry) {\n    if (this.geometry == null) {\n      this.geometry = v.bufferGeometry;\n    }\n  }\n\n  abstract lineType: AnyConstructor<TLine>;\n\n  get objectType(): AnyConstructor<TLine> {\n    return this.lineType;\n  }\n}\n","import type { QueryList } from '@angular/core';\nimport { ContentChild, ContentChildren, Directive } from '@angular/core';\nimport { Mesh } from 'three';\nimport type { AnyConstructor } from '../typings';\nimport { ThreeBufferGeometry } from './geometry.abstract';\nimport { ThreeMaterial } from './material.abstract';\nimport { ThreeObject3dMaterialGeometry } from './object-3d-material-geometry.abstract';\n\n@Directive()\nexport abstract class ThreeMesh<\n  TMesh extends Mesh = Mesh\n> extends ThreeObject3dMaterialGeometry<TMesh> {\n  @ContentChildren(ThreeMaterial) set materialDirectives(\n    v: QueryList<ThreeMaterial>\n  ) {\n    if (this.material == null && v) {\n      this.material =\n        v.length === 1\n          ? v.first.material\n          : v.toArray().map((dir) => dir.material);\n    }\n  }\n\n  @ContentChild(ThreeBufferGeometry)\n  set bufferGeometryDirective(v: ThreeBufferGeometry) {\n    if (this.geometry == null && v) {\n      this.geometry = v.bufferGeometry;\n    }\n  }\n\n  abstract meshType: AnyConstructor<TMesh>;\n\n  get objectType(): AnyConstructor<TMesh> {\n    return this.meshType;\n  }\n}\n","import {\n  AfterContentInit,\n  ContentChild,\n  Directive,\n  Input,\n} from '@angular/core';\nimport { Sprite, SpriteMaterial } from 'three';\nimport { AnyConstructor } from '../typings';\nimport { ThreeMaterial } from './material.abstract';\nimport { ThreeObject3d } from './object-3d.abstract';\n\n@Directive()\nexport abstract class ThreeSprite<TSprite extends Sprite = Sprite>\n  extends ThreeObject3d<TSprite>\n  implements AfterContentInit\n{\n  @Input() material?: SpriteMaterial;\n\n  @ContentChild(ThreeMaterial) materialDirective?: ThreeMaterial;\n\n  abstract spriteType: AnyConstructor<TSprite>;\n\n  private _sprite!: TSprite;\n\n  ngAfterContentInit() {\n    this.init();\n  }\n\n  protected initObject() {\n    if (this.material) {\n      this._sprite = new this.spriteType(this.material);\n      return;\n    }\n\n    if (this.materialDirective) {\n      if (this.materialDirective.material instanceof SpriteMaterial) {\n        this._sprite = new this.spriteType(this.materialDirective.material);\n        return;\n      }\n\n      console.warn(`Sprite can only be instantiated with SpriteMaterial`);\n    }\n  }\n\n  get object3d(): TSprite {\n    return this._sprite;\n  }\n}\n","import { Directive, OnInit } from '@angular/core';\nimport type { Camera } from 'three';\nimport type { AnyConstructor } from '../typings';\nimport { ThreeObject3d } from './object-3d.abstract';\n\n@Directive()\nexport abstract class ThreeCamera<TCamera extends Camera = Camera>\n  extends ThreeObject3d<TCamera>\n  implements OnInit\n{\n  abstract cameraType: AnyConstructor<TCamera>;\n\n  private _extraArgs: unknown[] = [];\n  protected set extraArgs(v: unknown[]) {\n    this._extraArgs = v;\n    this.ngZone.runOutsideAngular(() => {\n      this.init();\n    });\n  }\n\n  private _camera!: TCamera;\n\n  ngOnInit() {\n    if (!this.object3d) {\n      this.init();\n    }\n  }\n\n  protected initObject() {\n    this._camera = new this.cameraType(...this._extraArgs);\n  }\n\n  get object3d(): TCamera {\n    return this._camera;\n  }\n}\n","import {\n  Directive,\n  EventEmitter,\n  Inject,\n  Input,\n  NgZone,\n  OnDestroy,\n  OnInit,\n  Optional,\n  Output,\n  SkipSelf,\n} from '@angular/core';\nimport { Object3D } from 'three';\nimport { AnimationLoopParticipant, ThreeObject3d } from '../abstracts';\nimport { Object3dControllerDirective } from '../controllers';\nimport {\n  OBJECT_3D_CONTROLLER_PROVIDER,\n  OBJECT_3D_WATCHED_CONTROLLER,\n} from '../di';\nimport { AnimationStore, CanvasStore } from '../stores';\n\n@Directive({\n  selector: 'ngt-primitive',\n  exportAs: 'ngtPrimitive',\n  providers: [\n    {\n      provide: ThreeObject3d,\n      useExisting: PrimitiveDirective,\n    },\n    OBJECT_3D_CONTROLLER_PROVIDER,\n  ],\n})\nexport class PrimitiveDirective<TObject = unknown>\n  extends AnimationLoopParticipant<TObject>\n  implements OnInit, OnDestroy\n{\n  @Output() ready = new EventEmitter<TObject>();\n\n  get object(): TObject {\n    return this._object;\n  }\n\n  @Input()\n  set object(value: TObject) {\n    if (value == null) {\n      console.error('[object] is required');\n    }\n    this._object = value;\n    if (value) {\n      this.ready.emit(value);\n      this.participate(value);\n    }\n  }\n\n  private _object!: TObject;\n\n  constructor(\n    readonly animationStore: AnimationStore,\n    readonly ngZone: NgZone,\n    @Inject(OBJECT_3D_WATCHED_CONTROLLER)\n    private readonly object3dController: Object3dControllerDirective,\n    private readonly canvasStore: CanvasStore,\n    @Optional()\n    @SkipSelf()\n    protected readonly parentObjectDirective?: ThreeObject3d\n  ) {\n    super(animationStore, ngZone);\n  }\n\n  get object3d(): TObject {\n    return this._object;\n  }\n\n  ngOnInit() {\n    this.ngZone.runOutsideAngular(() => {\n      this.appendToParent();\n    });\n  }\n\n  ngOnDestroy() {\n    super.ngOnDestroy();\n    this.ngZone.runOutsideAngular(() => {\n      if (this.object3d) {\n        this.remove();\n      }\n    });\n  }\n\n  private appendToParent() {\n    if (this.object3d && this.object3d instanceof Object3D) {\n      if (this.object3dController.appendTo) {\n        this.object3dController.appendTo.add(this.object3d);\n        return;\n      }\n\n      const { scene } = this.canvasStore.getImperativeState();\n      if (this.object3dController.appendMode === 'root') {\n        if (scene) {\n          scene.add(this.object3d);\n        }\n        return;\n      }\n\n      if (this.object3dController.appendMode === 'immediate') {\n        if (this.parentObjectDirective) {\n          this.parentObjectDirective.object3d.add(this.object3d);\n        } else {\n          if (scene) {\n            scene.add(this.object3d);\n          }\n        }\n      }\n    }\n  }\n\n  protected remove() {\n    if (this.object3d instanceof Object3D) {\n      if (this.object3dController.appendTo) {\n        this.object3dController.appendTo.remove(this.object3d);\n      } else if (\n        this.parentObjectDirective &&\n        this.object3dController.appendMode === 'immediate'\n      ) {\n        this.parentObjectDirective.object3d.remove(this.object3d);\n      } else {\n        const { scene } = this.canvasStore.getImperativeState();\n        if (scene) {\n          scene.remove(this.object3d);\n        }\n      }\n\n      this.object3d.clear();\n    }\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { PrimitiveDirective } from './primitive.directive';\n\n@NgModule({\n  declarations: [PrimitiveDirective],\n  exports: [PrimitiveDirective],\n})\nexport class ThreePrimitiveModule {}\n","import { Pipe, PipeTransform } from '@angular/core';\n\n@Pipe({\n  name: 'math',\n  pure: true,\n})\nexport class MathPipe implements PipeTransform {\n  transform(\n    value: number | number[],\n    keyOfMath: keyof Omit<\n      Math,\n      | 'PI'\n      | 'E'\n      | 'LN2'\n      | 'LOG2E'\n      | 'LN10'\n      | 'LOG10E'\n      | 'SQRT1_2'\n      | 'SQRT2'\n      | 'random'\n    >\n  ): ReturnType<Extract<Math[typeof keyOfMath], 'string'>> {\n    const params: number[] = Array.isArray(value) ? value : [value];\n    return (Math[keyOfMath] as unknown as (...args: number[]) => number)(\n      ...params\n    ) as ReturnType<Extract<Math[typeof keyOfMath], 'string'>>;\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { MathPipe } from './math.pipe';\n\n@NgModule({\n  declarations: [MathPipe],\n  exports: [MathPipe],\n})\nexport class ThreeMathPipeModule {}\n","import { Pipe, PipeTransform } from '@angular/core';\n\n@Pipe({\n  name: 'mathConst',\n  pure: true,\n})\nexport class MathConstantPipe implements PipeTransform {\n  transform(\n    value: number | 0,\n    keyOfMathConst:\n      | 'PI'\n      | 'E'\n      | 'LN2'\n      | 'LOG2E'\n      | 'LN10'\n      | 'LOG10E'\n      | 'SQRT1_2'\n      | 'SQRT2'\n      | 'random'\n  ): number {\n    if (keyOfMathConst === 'random') {\n      return Math.random();\n    }\n\n    return value * Math[keyOfMathConst];\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { MathConstantPipe } from './math-constant.pipe';\n\n@NgModule({\n  declarations: [MathConstantPipe],\n  exports: [MathConstantPipe],\n})\nexport class ThreeMathConstantPipeModule {}\n","import { Pipe, PipeTransform } from '@angular/core';\nimport * as THREE from 'three';\n\n@Pipe({\n  name: 'color',\n  pure: true,\n})\nexport class ColorPipe implements PipeTransform {\n  /**\n   * ConstructorParameters<typeof THREE.Color> has a limitation on THREE.Color constructor overloads\n   */\n  transform(\n    args: Array<THREE.Color | string | number> | [number, number, number]\n  ): THREE.Color {\n    return new THREE.Color(...args);\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { ColorPipe } from './color.pipe';\n\n@NgModule({\n  declarations: [ColorPipe],\n  exports: [ColorPipe],\n})\nexport class ThreeColorPipeModule {}\n","import { Pipe, PipeTransform } from '@angular/core';\nimport * as THREE from 'three';\n\n@Pipe({\n  name: 'fog',\n  pure: true,\n})\nexport class FogPipe implements PipeTransform {\n  transform(args: ConstructorParameters<typeof THREE.Fog>): THREE.Fog {\n    return new THREE.Fog(...args);\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { FogPipe } from './fog.pipe';\n\n@NgModule({\n  declarations: [FogPipe],\n  exports: [FogPipe],\n})\nexport class ThreeFogPipeModule {}\n","import {\n  Directive,\n  Inject,\n  Input,\n  TemplateRef,\n  ViewContainerRef,\n} from '@angular/core';\n\nconst MAX_VALUE = 0x10000;\n\nexport interface RepeatContext {\n  $implicit: number;\n  isOdd: boolean;\n  isEven: boolean;\n  isFirst: boolean;\n  isLast: boolean;\n}\n\n@Directive({\n  selector: '[repeat][repeatOf]',\n})\nexport class RepeatDirective {\n  @Input()\n  set repeatOf(count: number) {\n    const safeCount = Math.floor(Math.max(0, Math.min(count, MAX_VALUE)));\n    const { length } = this.viewContainer;\n\n    if (safeCount < length) {\n      this.removeContainers(length - safeCount);\n    } else {\n      this.addContainers(length, safeCount);\n    }\n  }\n\n  constructor(\n    @Inject(ViewContainerRef) private readonly viewContainer: ViewContainerRef,\n    @Inject(TemplateRef)\n    private readonly templateRef: TemplateRef<RepeatContext>\n  ) {}\n\n  private addContainers(length: number, count: number) {\n    for (let index = length; index < count; index++) {\n      this.viewContainer.createEmbeddedView<RepeatContext>(this.templateRef, {\n        $implicit: index,\n        isFirst: index === length,\n        isLast: index === count - 1,\n        isOdd: !(index % 2),\n        isEven: !!(index % 2),\n      });\n    }\n  }\n\n  private removeContainers(amount: number) {\n    for (let index = 0; index < amount; index++) {\n      this.viewContainer.remove();\n    }\n  }\n\n  static ngTemplateContextGuard(\n    dir: RepeatDirective,\n    ctx: unknown\n  ): ctx is RepeatContext {\n    return true;\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { RepeatDirective } from './repeat.directive';\n\n@NgModule({\n  declarations: [RepeatDirective],\n  exports: [RepeatDirective],\n})\nexport class ThreeRepeatModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":["Vector3","ComponentStore","tap","withLatestFrom","skip","isObservable","filter","Injectable","Vector2","Clock","WebGLRenderer","PCFSoftShadowMap","ACESFilmicToneMapping","sRGBEncoding","Scene","Camera","OrthographicCamera","PerspectiveCamera","Raycaster","combineLatest","mapTo","Subject","forkJoin","of","defer","catchError","throwError","map","shareReplay","EventEmitter","fromEvent","takeUntil","observeOn","asapScheduler","DOCUMENT","Component","ChangeDetectionStrategy","Self","Inject","HostBinding","Input","Output","ViewChild","ReplaySubject","Directive","NgModule","InjectionToken","Optional","ChangeDetectorRef","Object3D","BehaviorSubject","Color","take","SkipSelf","Material","BufferGeometry","ContentChildren","ContentChild","SpriteMaterial","Pipe","THREE","ViewContainerRef","TemplateRef"],"mappings":"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"}