{"version":3,"file":"apply-props.util.js","sourceRoot":"","sources":["../../../../../../packages/core/src/lib/utils/apply-props.util.ts"],"names":[],"mappings":"AAMA,SAAS,oBAAoB,CAC3B,QAAuB,EACvB,GAAW,EACX,SAAkB,EAClB,MAAM,GAAG,IAAI;IAEb,MAAM,CAAC,KAAK,EAAE,GAAG,KAAK,CAAC,GAAG,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IACzC,MAAM,SAAS,GAAI,QAAqC,CAAC,KAAK,CAAC,CAAC;IAChE,IAAI,SAAS,IAAI,IAAI,EAAE;QACrB,OAAO;KACR;IAED,IAAI,KAAK,CAAC,MAAM,IAAI,CAAC,EAAE;QACrB,oBAAoB,CAClB,SAAqC,EACrC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,EACf,SAAS,EACT,KAAK,CACN,CAAC;KACH;SAAM;QACJ,QAAqC,CAAC,KAAK,CAAC,GAAG,SAAS,CAAC;KAC3D;IAED,IAAI,MAAM,EAAE;QACV,gBAAgB,CAAC,SAAS,CAAC,CAAC;KAC7B;AACH,CAAC;AAED,SAAS,gBAAgB,CAAC,KAAc;IACtC,IAAI,OAAO,KAAK,KAAK,QAAQ,IAAI,aAAa,IAAK,KAAuB,EAAE;QACzE,KAAuB,CAAC,aAAa,CAAC,GAAG,IAAI,CAAC;KAChD;AACH,CAAC;AAED;;;;;GAKG;AACH,MAAM,UAAU,UAAU,CAAC,QAAuB,EAAE,KAAqB;IACvE,IAAI,CAAC,KAAK,IAAI,CAAC,KAAK,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,MAAM,CAAC;QAAE,OAAO;IAE5D,IAAI,OAAO,IAAI,KAAK,EAAE;QACpB,QAAQ,CAAC,OAAO,CAAC,GAAG,KAAK,CAAC,OAAO,CAAqB,CAAC;KACxD;IAED,MAAM,eAAe,GAAG,QAAoC,CAAC;IAE7D,IACE,eAAe,CAAC,KAAK,CAAC,IAAI,IAAI;QAC9B,OAAO,eAAe,CAAC,KAAK,CAAC,KAAK,UAAU,EAC5C;QACC,eAAe,CAAC,KAAK,CAAc,CAAC,KAAK,CAAC,CAAC;KAC7C;IAED,KAAK,MAAM,CAAC,GAAG,EAAE,SAAS,CAAC,IAAI,MAAM,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE;QACpD,IAAI,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;YAC7B,oBAAoB,CAAC,QAAQ,EAAE,GAAG,EAAE,SAAS,CAAC,CAAC;SAChD;aAAM;YACL,MAAM,sBAAsB,GAAG,eAAe,CAAC,GAAG,CAAkB,CAAC;YACrE,IAAI,sBAAsB,IAAI,IAAI,EAAE;gBAClC,eAAe,CAAC,GAAG,CAAC,GAAG,SAAS,CAAC;aAClC;iBAAM;gBACL,IACE,sBAAsB,CAAC,KAAK,CAAC,IAAI,IAAI;oBACrC,OAAO,sBAAsB,CAAC,KAAK,CAAC,KAAK,UAAU,EACnD;oBACA,IAAI,KAAK,CAAC,OAAO,CAAC,SAAS,CAAC,EAAE;wBAC5B,IACE,sBAAsB,CAAC,WAAW,CAAC,IAAI,IAAI;4BAC3C,OAAO,sBAAsB,CAAC,WAAW,CAAC,KAAK,UAAU,EACzD;4BACA,sBAAsB,CAAC,WAAW,CAAC,CAAC,SAAS,CAAC,CAAC;yBAChD;6BAAM;4BACL,sBAAsB,CAAC,KAAK,CAAC,CAAC,GAAG,SAAS,CAAC,CAAC;yBAC7C;qBACF;yBAAM;wBACL,sBAAsB,CAAC,KAAK,CAAC,CAAC,SAAS,CAAC,CAAC;qBAC1C;iBACF;qBAAM;oBACL,eAAe,CAAC,GAAG,CAAC,GAAG,SAAS,CAAC;iBAClC;aACF;YACD,gBAAgB,CAAC,SAAS,CAAC,CAAC;SAC7B;KACF;AACH,CAAC","sourcesContent":["import type {\n  InstanceInternal,\n  ThreeInstance,\n  UnknownRecord,\n} from '../typings';\n\nfunction applyDottedPathProps(\n  instance: ThreeInstance,\n  key: string,\n  propAtKey: unknown,\n  isRoot = true\n) {\n  const [first, ...paths] = key.split('.');\n  const rootChild = (instance as unknown as UnknownRecord)[first];\n  if (rootChild == null) {\n    return;\n  }\n\n  if (paths.length >= 1) {\n    applyDottedPathProps(\n      rootChild as unknown as ThreeInstance,\n      paths.join('.'),\n      propAtKey,\n      false\n    );\n  } else {\n    (instance as unknown as UnknownRecord)[first] = propAtKey;\n  }\n\n  if (isRoot) {\n    checkNeedsUpdate(rootChild);\n  }\n}\n\nfunction checkNeedsUpdate(value: unknown) {\n  if (typeof value === 'object' && 'needsUpdate' in (value as UnknownRecord)) {\n    (value as UnknownRecord)['needsUpdate'] = true;\n  }\n}\n\n/**\n * Apply props on instances\n *\n * @internal\n * @private\n */\nexport function applyProps(instance: ThreeInstance, props?: UnknownRecord) {\n  if (!props || (props && !Object.keys(props).length)) return;\n\n  if ('__ngt' in props) {\n    instance['__ngt'] = props['__ngt'] as InstanceInternal;\n  }\n\n  const unknownInstance = instance as unknown as UnknownRecord;\n\n  if (\n    unknownInstance['set'] != null &&\n    typeof unknownInstance['set'] === 'function'\n  ) {\n    (unknownInstance['set'] as Function)(props);\n  }\n\n  for (const [key, propAtKey] of Object.entries(props)) {\n    if (key.split('.').length > 1) {\n      applyDottedPathProps(instance, key, propAtKey);\n    } else {\n      const threeInstancePropAtKey = unknownInstance[key] as UnknownRecord;\n      if (threeInstancePropAtKey == null) {\n        unknownInstance[key] = propAtKey;\n      } else {\n        if (\n          threeInstancePropAtKey['set'] != null &&\n          typeof threeInstancePropAtKey['set'] === 'function'\n        ) {\n          if (Array.isArray(propAtKey)) {\n            if (\n              threeInstancePropAtKey['fromArray'] != null &&\n              typeof threeInstancePropAtKey['fromArray'] === 'function'\n            ) {\n              threeInstancePropAtKey['fromArray'](propAtKey);\n            } else {\n              threeInstancePropAtKey['set'](...propAtKey);\n            }\n          } else {\n            threeInstancePropAtKey['set'](propAtKey);\n          }\n        } else {\n          unknownInstance[key] = propAtKey;\n        }\n      }\n      checkNeedsUpdate(propAtKey);\n    }\n  }\n}\n"]}